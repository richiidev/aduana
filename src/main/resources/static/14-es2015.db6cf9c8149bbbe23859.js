(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{IPPq:function(o,r,e){"use strict";e.r(r),e.d(r,"UsuariosTabsPageModule",(function(){return C}));var t=e("ofXK"),i=e("TEn/"),n=e("tyNb"),s=e("mrSG"),a=e("AytR"),l=e("3Pt+"),c=e("fXoL"),b=e("tk/3");function u(o,r){if(1&o&&(c.Kb(0,"ion-select-option",15),c.ec(1),c.Jb()),2&o){const o=r.$implicit;c.Xb("value",o.id),c.xb(1),c.fc(o.rol)}}let d=(()=>{class o{constructor(o,r,e){this.modalCtrl=o,this.http=r,this.toastCtrl=e}ngOnInit(){this.cargarForm(),this.modalCtrl.getTop().then(o=>{this.usuario=o.componentProps,console.log("Los datos recibidos son",o.componentProps),this.usuarioForm.setValue({correo:this.usuario.correo,idrol:this.usuario.idrol.id,nombre:this.usuario.nombre,apellidos:this.usuario.apellidos})}).catch(o=>console.log("Error al cargar el modal",o))}actualizarUsuario(){const o={id:this.usuario.id,correo:this.usuarioForm.controls.correo.value,idrol:{id:this.usuarioForm.controls.idrol.value},nombre:this.usuarioForm.controls.nombre.value,apellidos:this.usuarioForm.controls.apellidos.value};this.http.put(a.a.apiUrl+"/usuario",o).subscribe(r=>{r.success?(console.log("Resp de actualizar usuario",r),this.cerrarModal(!0,o)):this.mostrarToast("Error algo salio mal...","danger")},o=>{this.mostrarToast("Error algo salio mal...","danger"),console.log("Error al actualizar el usuario",o)})}mostrarToast(o,r){return Object(s.a)(this,void 0,void 0,(function*(){return(yield this.toastCtrl.create({message:o,color:r,duration:3e3})).present()}))}cargarForm(){this.usuarioForm=new l.c({correo:new l.a(null,[l.l.required]),idrol:new l.a(null,l.l.required),nombre:new l.a(null,l.l.required),apellidos:new l.a(null,l.l.required)}),this.http.get(a.a.apiUrl+"/rol").subscribe(o=>{0!=o.data.length&&(this.roles=o.data),console.log("Resp de los roles",o)},o=>{console.log("Error en obtener roles",o)})}cerrarModal(o,r){this.modalCtrl.dismiss({completado:o,nuevo:r})}}return o.\u0275fac=function(r){return new(r||o)(c.Hb(i.M),c.Hb(b.a),c.Hb(i.Q))},o.\u0275cmp=c.Bb({type:o,selectors:[["app-editar-usuario"]],decls:37,vars:5,consts:[[1,"ion-text-center"],["slot","start"],["color","dark",3,"click"],["name","chevron-back-circle"],[3,"formGroup"],["position","floating"],["color","danger"],["required","","formControlName","correo","type","text"],["required","","formControlName","nombre","type","text"],["required","","formControlName","apellidos","type","text"],["formControlName","idrol","interface","popover","placeholder","Roles"],[3,"value",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"disabled","click"],["name","save",2,"font-size","50px"],[3,"value"]],template:function(o,r){1&o&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-buttons",1),c.Kb(3,"ion-button",2),c.Sb("click",(function(){return r.cerrarModal(!1)})),c.Ib(4,"ion-icon",3),c.ec(5," Cancelar "),c.Jb(),c.Jb(),c.Kb(6,"ion-title"),c.ec(7),c.Jb(),c.Jb(),c.Jb(),c.Kb(8,"ion-content"),c.Kb(9,"ion-card"),c.Kb(10,"form",4),c.Kb(11,"ion-item"),c.Kb(12,"ion-label",5),c.ec(13,"Correo "),c.Kb(14,"ion-text",6),c.ec(15,"*"),c.Jb(),c.Jb(),c.Ib(16,"ion-input",7),c.Jb(),c.Kb(17,"ion-item"),c.Kb(18,"ion-label",5),c.ec(19,"Nombres"),c.Kb(20,"ion-text",6),c.ec(21,"*"),c.Jb(),c.Jb(),c.Ib(22,"ion-input",8),c.Jb(),c.Kb(23,"ion-item"),c.Kb(24,"ion-label",5),c.ec(25,"Apellidos"),c.Kb(26,"ion-text",6),c.ec(27,"*"),c.Jb(),c.Jb(),c.Ib(28,"ion-input",9),c.Jb(),c.Kb(29,"ion-item"),c.Kb(30,"ion-label"),c.ec(31,"Selecciona el rol del usuario"),c.Jb(),c.Kb(32,"ion-select",10),c.dc(33,u,2,2,"ion-select-option",11),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Kb(34,"ion-fab",12),c.Kb(35,"ion-fab-button",13),c.Sb("click",(function(){return r.actualizarUsuario()})),c.Ib(36,"ion-icon",14),c.Jb(),c.Jb(),c.Jb()),2&o&&(c.xb(7),c.hc("",null==r.usuario?null:r.usuario.nombre," ",null==r.usuario?null:r.usuario.apellidos,""),c.xb(3),c.Xb("formGroup",r.usuarioForm),c.xb(23),c.Xb("ngForOf",r.roles),c.xb(2),c.Xb("disabled",!r.usuarioForm.touched))},directives:[i.o,i.H,i.e,i.d,i.p,i.G,i.k,i.f,l.m,l.i,l.d,i.r,i.s,i.F,i.q,i.P,l.k,l.h,l.b,i.z,i.O,t.h,i.l,i.m,i.A],styles:[""]}),o})();function m(o,r){if(1&o&&(c.Kb(0,"ion-card"),c.Kb(1,"ion-card-header",0),c.Kb(2,"ion-card-title"),c.ec(3),c.Jb(),c.Jb(),c.Kb(4,"ion-card-content"),c.Kb(5,"ion-grid",6),c.Kb(6,"ion-row"),c.Kb(7,"ion-col",7),c.Kb(8,"ion-text",8),c.Kb(9,"h1"),c.ec(10,"Correo"),c.Jb(),c.Jb(),c.Jb(),c.Kb(11,"ion-col",7),c.Kb(12,"p",9),c.ec(13),c.Jb(),c.Jb(),c.Jb(),c.Kb(14,"ion-row"),c.Kb(15,"ion-col",7),c.Kb(16,"ion-text",8),c.Kb(17,"h1"),c.ec(18,"Nombres"),c.Jb(),c.Jb(),c.Jb(),c.Kb(19,"ion-col",7),c.Kb(20,"p",9),c.ec(21),c.Jb(),c.Jb(),c.Jb(),c.Kb(22,"ion-row"),c.Kb(23,"ion-col",7),c.Kb(24,"ion-text",8),c.Kb(25,"h1"),c.ec(26,"Apellidos"),c.Jb(),c.Jb(),c.Jb(),c.Kb(27,"ion-col",7),c.Kb(28,"p",9),c.ec(29),c.Jb(),c.Jb(),c.Jb(),c.Kb(30,"ion-row"),c.Kb(31,"ion-col",7),c.Kb(32,"ion-text",8),c.Kb(33,"h1"),c.ec(34,"Rol"),c.Jb(),c.Jb(),c.Jb(),c.Kb(35,"ion-col",7),c.Kb(36,"p",9),c.ec(37),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Jb()),2&o){const o=c.Ub();c.xb(3),c.hc("",null==o.usuario?null:o.usuario.nombre," ",null==o.usuario?null:o.usuario.apellidos,""),c.xb(10),c.fc(o.usuario.correo),c.xb(8),c.gc(" ",o.usuario.nombre," "),c.xb(8),c.gc(" ",o.usuario.apellidos,""),c.xb(8),c.gc(" ",o.usuario.idrol.rol,"")}}let p=(()=>{class o{constructor(o,r,e,t){this.http=o,this.toastCtrl=r,this.actionSheetController=e,this.modalCtrl=t}ngOnInit(){}buscarUsuario(o){this.peticionUsuario(o.target.value)}peticionUsuario(o){this.http.get(`${a.a.apiUrl}/usuario/rfc?rfc=${o}`).subscribe(o=>{console.log("Resp de buscar usuario",o),1==o.data.length?this.usuario=o.data[0]:(this.mostrarToast("No se encontro el usuario","danger"),this.usuario=void 0)},o=>{console.log("Error al buscar usuario",o)})}editarUsuario(){return Object(s.a)(this,void 0,void 0,(function*(){const o=yield this.modalCtrl.create({component:d,componentProps:this.usuario,backdropDismiss:!1});yield o.present();const r=yield o.onWillDismiss();r.data.completado&&(this.mostrarToast("Se gurdo correctamente"," success"),console.log("ASi vienen los datos ",r.data),this.usuario.correo=r.data.nuevo.correo,this.usuario.idrol.id=r.data.nuevo.idrol.id,this.usuario.nombre=r.data.nuevo.nombre,this.usuario.apellidos=r.data.nuevo.apellidos)}))}mostrarOpciones(){return Object(s.a)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Que deseas hacer con el usuario",cssClass:"my-custom-class",buttons:[{text:"Eliminar",icon:"trash",handler:()=>{console.log("Delete clicked")}},{text:"Editar",icon:"create",handler:()=>{this.editarUsuario()}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield o.present()}))}mostrarToast(o,r){return Object(s.a)(this,void 0,void 0,(function*(){return(yield this.toastCtrl.create({message:o,color:r,duration:3e3})).present()}))}}return o.\u0275fac=function(r){return new(r||o)(c.Hb(b.a),c.Hb(i.Q),c.Hb(i.a),c.Hb(i.M))},o.\u0275cmp=c.Bb({type:o,selectors:[["app-buscar-usuario"]],decls:10,vars:3,consts:[[1,"ion-text-center"],["placeholder","Ingresa el RFC del usuario","type","text",3,"debounce","ionChange"],[4,"ngIf"],["vertical","bottom","horizontal","start","slot","fixed"],[3,"disabled","click"],["name","man",2,"font-size","50px"],["fixed",""],["size","6"],["color","primary"],[2,"font-weight","bold","color","black"]],template:function(o,r){1&o&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-title"),c.ec(3,"Buscar usuario"),c.Jb(),c.Kb(4,"ion-searchbar",1),c.Sb("ionChange",(function(o){return r.buscarUsuario(o)})),c.Jb(),c.Jb(),c.Jb(),c.Kb(5,"ion-content"),c.dc(6,m,38,6,"ion-card",2),c.Kb(7,"ion-fab",3),c.Kb(8,"ion-fab-button",4),c.Sb("click",(function(){return r.mostrarOpciones()})),c.Ib(9,"ion-icon",5),c.Jb(),c.Jb(),c.Jb()),2&o&&(c.xb(4),c.Xb("debounce",1e3),c.xb(2),c.Xb("ngIf",null!=r.usuario),c.xb(2),c.Xb("disabled",null==r.usuario))},directives:[i.o,i.H,i.G,i.y,i.P,i.k,t.i,i.l,i.m,i.p,i.f,i.h,i.i,i.g,i.n,i.x,i.j,i.F],styles:[""]}),o})();function h(o,r){1&o&&(c.Kb(0,"p"),c.ec(1,"El RFC es necesario"),c.Jb())}function f(o,r){if(1&o&&(c.Kb(0,"ion-text",3),c.dc(1,h,2,0,"p",16),c.Kb(2,"p"),c.ec(3," El RFC "),c.Kb(4,"ion-badge",17),c.ec(5,"NO ESTA disponible"),c.Jb(),c.Jb(),c.Jb()),2&o){const o=c.Ub();c.xb(1),c.Xb("ngIf",(null==o.usuarioForm.controls.rfc.errors?null:o.usuarioForm.controls.rfc.errors.required)&&o.usuarioForm.controls.rfc.dirty)}}function J(o,r){1&o&&(c.Kb(0,"ion-text",18),c.Kb(1,"p"),c.ec(2," El RFC esta "),c.Kb(3,"ion-badge",19),c.ec(4,"DISPONIBLE"),c.Jb(),c.Jb(),c.Jb())}function K(o,r){if(1&o&&(c.Kb(0,"ion-select-option",20),c.ec(1),c.Jb()),2&o){const o=r.$implicit;c.Xb("value",o.id),c.xb(1),c.fc(o.rol)}}function g(o,r){1&o&&(c.Kb(0,"ion-text",3),c.Kb(1,"p"),c.ec(2,"Las contrase\xf1as NO son iguales"),c.Jb(),c.Jb())}let x=(()=>{class o{constructor(o,r){this.http=o,this.toastCtrl=r}ngOnInit(){this.cargarFormulario()}registrarce(){const o={nombre:this.usuarioForm.controls.nombre.value,apellidos:this.usuarioForm.controls.apellidos.value,correo:this.usuarioForm.controls.correo.value,rfc:this.usuarioForm.controls.rfc.value,password:this.usuarioForm.controls.password2.value,idrol:{id:this.usuarioForm.controls.rol.value}};console.log("El usuario seria",o),this.http.post(a.a.apiUrl+"/usuario",o).subscribe(o=>{o.success?(this.mostrarToast("Se registro correctamente","success"),this.usuarioForm.reset({nombre:null,apellidos:null,correo:null,rfc:null,password:null,rol:null})):this.mostrarToast("Algo salio mal","danger"),console.log("Resp al crear usuario",o)},o=>console.log("Ocurrio un error al crear el usuario",o))}mostrarToast(o,r){return Object(s.a)(this,void 0,void 0,(function*(){return(yield this.toastCtrl.create({message:o,color:r,duration:3e3})).present()}))}cargarFormulario(){this.usuarioForm=new l.c({nombre:new l.a(null,[l.l.required,l.l.minLength(6)]),apellidos:new l.a(null,[l.l.required,l.l.minLength(6)]),correo:new l.a(null,[l.l.required,l.l.minLength(6)]),rfc:new l.a(null,[l.l.required,l.l.minLength(6)],this.rfcUnico.bind(this)),rol:new l.a(null,[l.l.required]),password:new l.a(null,[l.l.required,l.l.minLength(5)]),password2:new l.a(null,[l.l.required,l.l.min(5)])},{validators:this.compararContras}),this.http.get(a.a.apiUrl+"/rol").subscribe(o=>{0!=o.data.length&&(this.roles=o.data),console.log("Resp de los roles",o)},o=>{console.log("Error en obtener roles",o)})}compararContras(o){return o.controls.password2.value===o.controls.password.value?null:{mismatch:!0}}rfcUnico(o){return new Promise((o,r)=>{this.http.get(`${a.a.apiUrl}/usuario/rfc/?rfc=${this.usuarioForm.controls.rfc.value}`).subscribe(r=>{console.log("Se hizo bien",r),o(1==r.data.length?{existe:!0}:null)},r=>{console.log("Se hizo MAL",r),o({existe:!0})})})}}return o.\u0275fac=function(r){return new(r||o)(c.Hb(b.a),c.Hb(i.Q))},o.\u0275cmp=c.Bb({type:o,selectors:[["app-crear-usuario"]],decls:54,vars:6,consts:[["color","tertiary",1,"ion-text-center"],[3,"formGroup"],["position","floating"],["color","danger"],["required","","formControlName","nombre","type","text"],["required","","formControlName","apellidos","type","text"],["required","","formControlName","correo","type","text"],["debounce","1000","required","","formControlName","rfc","type","text"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["formControlName","rol","interface","popover","placeholder","Roles"],[3,"value",4,"ngFor","ngForOf"],["required","","formControlName","password","type","password"],["formControlName","password2","type","password"],["expand","full","color","primary",3,"disabled","click"],["name","person-add"],[4,"ngIf"],["color","danger","mode","ios"],["color","success"],["color","success","mode","ios"],[3,"value"]],template:function(o,r){1&o&&(c.Kb(0,"ion-header"),c.Kb(1,"ion-toolbar",0),c.Kb(2,"ion-title"),c.ec(3,"Crear usuario"),c.Jb(),c.Jb(),c.Jb(),c.Kb(4,"ion-content"),c.Kb(5,"ion-card"),c.Kb(6,"form",1),c.Kb(7,"ion-item"),c.Kb(8,"ion-label",2),c.ec(9,"Nombres "),c.Kb(10,"ion-text",3),c.ec(11,"*"),c.Jb(),c.Jb(),c.Ib(12,"ion-input",4),c.Jb(),c.Kb(13,"ion-item"),c.Kb(14,"ion-label",2),c.ec(15,"Apellidos "),c.Kb(16,"ion-text",3),c.ec(17,"*"),c.Jb(),c.Jb(),c.Ib(18,"ion-input",5),c.Jb(),c.Kb(19,"ion-item"),c.Kb(20,"ion-label",2),c.ec(21,"Correo electronico "),c.Kb(22,"ion-text",3),c.ec(23,"*"),c.Jb(),c.Jb(),c.Ib(24,"ion-input",6),c.Jb(),c.Kb(25,"ion-item"),c.Kb(26,"ion-label",2),c.ec(27,"RFC "),c.Kb(28,"ion-text",3),c.ec(29,"*"),c.Jb(),c.Jb(),c.Ib(30,"ion-input",7),c.dc(31,f,6,1,"ion-text",8),c.dc(32,J,5,0,"ion-text",9),c.Jb(),c.Kb(33,"ion-item"),c.Kb(34,"ion-label"),c.ec(35,"Selecciona el rol del usuario"),c.Jb(),c.Kb(36,"ion-select",10),c.dc(37,K,2,2,"ion-select-option",11),c.Jb(),c.Jb(),c.Kb(38,"ion-item"),c.Kb(39,"ion-label",2),c.ec(40,"Contrasena "),c.Kb(41,"ion-text",3),c.ec(42,"*"),c.Jb(),c.Jb(),c.Ib(43,"ion-input",12),c.Jb(),c.Kb(44,"ion-item"),c.Kb(45,"ion-label",2),c.ec(46,"Repite tu contrasena "),c.Kb(47,"ion-text",3),c.ec(48,"*"),c.Jb(),c.Jb(),c.Ib(49,"ion-input",13),c.dc(50,g,3,0,"ion-text",8),c.Jb(),c.Jb(),c.Kb(51,"ion-button",14),c.Sb("click",(function(){return r.registrarce()})),c.ec(52," Crear usuario "),c.Ib(53,"ion-icon",15),c.Jb(),c.Jb(),c.Jb()),2&o&&(c.xb(6),c.Xb("formGroup",r.usuarioForm),c.xb(25),c.Xb("ngIf",null==r.usuarioForm.controls.rfc.errors?null:r.usuarioForm.controls.rfc.errors.existe),c.xb(1),c.Xb("ngIf",r.usuarioForm.controls.rfc.valid),c.xb(5),c.Xb("ngForOf",r.roles),c.xb(13),c.Xb("ngIf",(null==r.usuarioForm.errors?null:r.usuarioForm.errors.mismatch)&&(r.usuarioForm.controls.password2.dirty||r.usuarioForm.controls.password2.touched)),c.xb(1),c.Xb("disabled",r.usuarioForm.invalid))},directives:[i.o,i.H,i.G,i.k,i.f,l.m,l.i,l.d,i.r,i.s,i.F,i.q,i.P,l.k,l.h,l.b,t.i,i.z,i.O,t.h,i.d,i.p,i.c,i.A],styles:[""]}),o})();const v=[{path:"",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(r){return new(r||o)},o.\u0275cmp=c.Bb({type:o,selectors:[["app-usuarios-tabs"]],decls:10,vars:0,consts:[["color","tertiary"],["tab","crear"],["name","add"],["tab","buscar"],["name","search"]],template:function(o,r){1&o&&(c.Kb(0,"ion-tabs"),c.Kb(1,"ion-tab-bar",0),c.Kb(2,"ion-tab-button",1),c.Ib(3,"ion-icon",2),c.Kb(4,"ion-label"),c.ec(5,"Crear"),c.Jb(),c.Jb(),c.Kb(6,"ion-tab-button",3),c.Ib(7,"ion-icon",4),c.Kb(8,"ion-label"),c.ec(9,"Buscar"),c.Jb(),c.Jb(),c.Jb(),c.Jb())},directives:[i.E,i.C,i.D,i.p,i.s],styles:[""]}),o})(),children:[{path:"",redirectTo:"crear",pathMatch:"full"},{path:"crear",component:x},{path:"buscar",component:p}]}];let F=(()=>{class o{}return o.\u0275mod=c.Fb({type:o}),o.\u0275inj=c.Eb({factory:function(r){return new(r||o)},imports:[[n.h.forChild(v)],n.h]}),o})(),C=(()=>{class o{}return o.\u0275mod=c.Fb({type:o}),o.\u0275inj=c.Eb({factory:function(r){return new(r||o)},imports:[[t.b,i.J,F,l.e,l.j,b.b]]}),o})()}}]);