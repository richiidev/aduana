(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"R+XL":function(t,e,a){"use strict";a.r(e),a.d(e,"AgenteModule",(function(){return I}));var c=a("ofXK"),n=a("0EQZ"),i=a("S2gQ"),r=a("AytR"),o=a("fXoL"),b=a("tk/3"),s=a("dNgK"),l=a("lGQG"),u=a("/t3+"),d=a("bTqV"),m=a("STbY"),h=a("NFeN"),f=a("f0Cb"),p=a("zkoq"),g=a("vxfF"),w=a("+0xr"),R=a("bSwM"),Q=a("MutI");function v(t,e){1&t&&o.Mb(0,"tr",25)}function k(t,e){1&t&&o.Mb(0,"tr",26)}function M(t,e){if(1&t){const t=o.Sb();o.Rb(0,"th",27),o.Rb(1,"mat-checkbox",28),o.Yb("change",(function(e){o.nc(t);const a=o.cc();return e?a.masterToggle():null})),o.Qb(),o.Qb()}if(2&t){const t=o.cc();o.Ab(1),o.hc("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function A(t,e){if(1&t){const t=o.Sb();o.Rb(0,"td",29),o.Rb(1,"mat-checkbox",30),o.Yb("click",(function(e){return o.nc(t),e.stopPropagation()}))("change",(function(a){o.nc(t);const c=e.$implicit,n=o.cc();return a?n.selection.toggle(c):null})),o.Qb(),o.Qb()}if(2&t){const t=e.$implicit,a=o.cc();o.Ab(1),o.hc("checked",a.selection.isSelected(t))("aria-label",a.checkboxLabel(t))}}function C(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"RFC"),o.Qb())}function P(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.rfc)}}function S(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"AWB"),o.Qb())}function x(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.awb)}}function D(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"HBW"),o.Qb())}function F(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.hbw)}}function O(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"Pedimento"),o.Qb())}function $(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.pedimento)}}function y(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"Fecha"),o.Qb())}function _(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.fecha)}}function T(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"Agente"),o.Qb())}function j(t,e){if(1&t&&(o.Rb(0,"td",29),o.wc(1),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.xc(t.agente)}}function E(t,e){1&t&&(o.Rb(0,"th",27),o.wc(1,"Opciones"),o.Qb())}function L(t,e){if(1&t){const t=o.Sb();o.Rb(0,"td",29),o.Rb(1,"button",31),o.Yb("click",(function(){o.nc(t);const a=e.$implicit;return o.cc().abrirSeleccionado(a.factura,"pdf")})),o.Rb(2,"mat-icon",32),o.wc(3," picture_as_pdf "),o.Qb(),o.Qb(),o.Rb(4,"button",31),o.Yb("click",(function(){o.nc(t);const a=e.$implicit;return o.cc().abrirSeleccionado(a.factura,"xml")})),o.Rb(5,"mat-icon",32),o.wc(6," code "),o.Qb(),o.Qb(),o.Qb()}}let H=(()=>{class t{constructor(t,e,a){this.http=t,this.mensajeCtrl=e,this.auth=a,this.selection=new n.c(!0,[]),this.displayedColumnsPrueba=["select","rfc","awb","hbw","pedimento","fecha","agente","opciones"],this.facturaTabla=new i.b([])}ngOnInit(){this.cargarFacturas()}cargarFacturas(){this.http.get(`${r.a.apiUrl}/facturas/agente?agente=${this.auth.usuario.rfc}`).subscribe(t=>{console.log("Resp de buscar factura",t),t.data.length>0?(this.facturaTabla=new i.b(t.data),this.mostrarMensaje("Se encontraron","snackVerde")):this.mostrarMensaje("No se encotraron","snackRojo")},t=>{console.log("Error al buscar la factura",t)})}descargarXmls(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".xml")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}descargarPdfs(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".pdf")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}isAllSelected(){return this.selection.selected.length===this.facturaTabla.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.facturaTabla.data.forEach(t=>this.selection.select(t))}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.position+1}`:(this.isAllSelected()?"select":"deselect")+" all"}mostrarMensaje(t,e){this.mensajeCtrl.open(t,null,{duration:3e3,verticalPosition:"bottom",panelClass:[e]})}descargarPdfsYXmls(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".pdf"),t.push(e.factura+".xml")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}generarZip(t,e){this.http.post(`${r.a.apiUrl}/crearZip?zipFile=${t}`,e).toPromise().then(e=>{console.log("Resp de hacer zip archivos",e),e.success?this.descargarZip(t):this.mostrarMensaje("Error al descargar el zip","snackRojo")}).catch(t=>{console.log("Error al comprimir archios",t),this.mostrarMensaje("Error al descargar el zip","snackRojo")})}descargarZip(t){var e=document.createElement("a");e.href=`${r.a.apiFile}/file/${t}.zip`,e.download=t,e.click(),e.remove()}abrirSeleccionado(t,e){console.log(t);var a=document.createElement("a");a.href=`${r.a.apiFile}/file/${t}.${e}`,a.setAttribute("target","_blank"),a.click(),a.remove()}}return t.\u0275fac=function(e){return new(e||t)(o.Lb(b.a),o.Lb(s.a),o.Lb(l.a))},t.\u0275cmp=o.Fb({type:t,selectors:[["app-facturas"]],decls:81,vars:12,consts:[["color","primary",2,"text-align","right"],["mat-button","",3,"matMenuTriggerFor"],["perfil","matMenu"],[2,"text-align","center"],["src","assets/imgs/avatar-01.jpg","alt",""],[2,"font-weight","bold"],["mat-menu-item","",3,"click"],["cols","3","rowHeight","2:1"],["mat-raised-button","",3,"matMenuTriggerFor"],["mat-raised-button",""],["exportar","matMenu"],["tvsItemSize","",1,"wrapper","mat-elevation-z2"],["mat-table","",3,"dataSource"],["mat-header-row","","class","tablaHeader",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","rfc"],["matColumnDef","awb"],["matColumnDef","hbw"],["matColumnDef","pedimento"],["matColumnDef","fecha"],["matColumnDef","agente"],["matColumnDef","opciones"],["mat-header-row","",1,"tablaHeader"],["mat-row",""],["mat-header-cell",""],[2,"background","white",3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[2,"background","white",3,"checked","aria-label","click","change"],[3,"click"],["mat-list-icon",""]],template:function(t,e){if(1&t&&(o.Rb(0,"p"),o.Rb(1,"mat-toolbar",0),o.Rb(2,"button",1),o.wc(3),o.Rb(4,"mat-icon"),o.wc(5,"expand_more"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(6,"mat-menu",null,2),o.Rb(8,"div",3),o.Mb(9,"img",4),o.Rb(10,"p",5),o.wc(11),o.Qb(),o.Mb(12,"mat-divider"),o.Rb(13,"p"),o.wc(14),o.Qb(),o.Mb(15,"mat-divider"),o.Qb(),o.Rb(16,"div",3),o.Rb(17,"span"),o.wc(18),o.dc(19,"uppercase"),o.Qb(),o.Qb(),o.Mb(20,"mat-divider"),o.Rb(21,"button",6),o.Yb("click",(function(){return e.auth.cerrarSesion()})),o.Rb(22,"mat-icon"),o.wc(23,"assignment_return"),o.Qb(),o.Rb(24,"span"),o.wc(25,"Cerrar sesion"),o.Qb(),o.Qb(),o.Qb(),o.Rb(26,"mat-grid-list",7),o.Rb(27,"mat-grid-tile"),o.Rb(28,"button",8),o.wc(29," Exportar "),o.Qb(),o.Qb(),o.Rb(30,"mat-grid-tile"),o.Rb(31,"button",9),o.wc(32," Hoy "),o.Qb(),o.Qb(),o.Rb(33,"mat-grid-tile"),o.Rb(34,"button",9),o.wc(35," Filtro "),o.Qb(),o.Qb(),o.Qb(),o.Rb(36,"mat-menu",null,10),o.Rb(38,"button",6),o.Yb("click",(function(){return e.descargarPdfsYXmls()})),o.Rb(39,"mat-icon"),o.wc(40,"cloud_download"),o.Qb(),o.Rb(41,"span"),o.wc(42,"Descargar archivos PDFs y XMLs"),o.Qb(),o.Qb(),o.Rb(43,"button",6),o.Yb("click",(function(){return e.descargarPdfs()})),o.Rb(44,"mat-icon"),o.wc(45,"cloud_download"),o.Qb(),o.Rb(46,"span"),o.wc(47,"Descargar solo PDFs"),o.Qb(),o.Qb(),o.Rb(48,"button",6),o.Yb("click",(function(){return e.descargarXmls()})),o.Rb(49,"mat-icon"),o.wc(50,"cloud_download"),o.Qb(),o.Rb(51,"span"),o.wc(52,"Descargar solo XMLs"),o.Qb(),o.Qb(),o.Qb(),o.Rb(53,"cdk-virtual-scroll-viewport",11),o.Rb(54,"table",12),o.vc(55,v,1,0,"tr",13),o.vc(56,k,1,0,"tr",14),o.Pb(57,15),o.vc(58,M,2,3,"th",16),o.vc(59,A,2,2,"td",17),o.Ob(),o.Pb(60,18),o.vc(61,C,2,0,"th",16),o.vc(62,P,2,1,"td",17),o.Ob(),o.Pb(63,19),o.vc(64,S,2,0,"th",16),o.vc(65,x,2,1,"td",17),o.Ob(),o.Pb(66,20),o.vc(67,D,2,0,"th",16),o.vc(68,F,2,1,"td",17),o.Ob(),o.Pb(69,21),o.vc(70,O,2,0,"th",16),o.vc(71,$,2,1,"td",17),o.Ob(),o.Pb(72,22),o.vc(73,y,2,0,"th",16),o.vc(74,_,2,1,"td",17),o.Ob(),o.Pb(75,23),o.vc(76,T,2,0,"th",16),o.vc(77,j,2,1,"td",17),o.Ob(),o.Pb(78,24),o.vc(79,E,2,0,"th",16),o.vc(80,L,7,0,"td",17),o.Ob(),o.Qb(),o.Qb()),2&t){const t=o.mc(7),a=o.mc(37);o.Ab(2),o.hc("matMenuTriggerFor",t),o.Ab(1),o.yc(" ",null==e.auth.usuario?null:e.auth.usuario.nombre," "),o.Ab(8),o.xc(null==e.auth.usuario?null:e.auth.usuario.nombre),o.Ab(3),o.xc(null==e.auth.usuario?null:e.auth.usuario.correo),o.Ab(4),o.xc(o.ec(19,10,null==e.auth.usuario?null:e.auth.usuario.idrol.rol)),o.Ab(10),o.hc("matMenuTriggerFor",a),o.Ab(26),o.hc("dataSource",e.facturaTabla),o.Ab(1),o.hc("matHeaderRowDef",e.displayedColumnsPrueba)("matHeaderRowDefSticky",!0),o.Ab(1),o.hc("matRowDefColumns",e.displayedColumnsPrueba)}},directives:[u.a,d.a,m.c,h.a,m.d,f.a,m.a,p.a,p.c,g.c,i.a,w.j,w.g,w.i,w.c,w.e,w.b,w.f,w.h,w.d,R.a,w.a,Q.b],pipes:[c.p],styles:[".wrapper[_ngcontent-%COMP%]{height:550px}table[_ngcontent-%COMP%]{width:100%}.mat-toolbar[_ngcontent-%COMP%]{background:#ebebeb;color:#000}.tablaHeader[_ngcontent-%COMP%]{font-size:14px;background-color:#0f0f0f}.mat-header-cell[_ngcontent-%COMP%]{color:#fff}"]}),t})();var Y=a("tyNb"),X=a("XhcP");function z(t,e){if(1&t&&(o.Rb(0,"div"),o.Rb(1,"mat-list-item",4),o.wc(2),o.Rb(3,"mat-icon",5),o.wc(4),o.Qb(),o.Qb(),o.Mb(5,"mat-divider"),o.Qb()),2&t){const t=e.$implicit;o.Ab(1),o.hc("routerLink",t.ruta),o.Ab(1),o.yc(" ",t.titulo," "),o.Ab(2),o.yc(" ",t.icon,"")}}const Z=[{path:"",component:(()=>{class t{constructor(){this.menuOpciones=[{icon:"receipt",ruta:"facturas",titulo:"Facturas"}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Fb({type:t,selectors:[["app-agente"]],decls:8,vars:1,consts:[["mode","side","opened",""],[2,"text-align","center"],["src","assets/imgs/logo_swissport_mini.png","alt",""],[4,"ngFor","ngForOf"],[2,"text-align","right",3,"routerLink"],["mat-list-icon",""]],template:function(t,e){1&t&&(o.Rb(0,"mat-sidenav-container"),o.Rb(1,"mat-sidenav",0),o.Rb(2,"mat-toolbar",1),o.Mb(3,"img",2),o.Qb(),o.Rb(4,"mat-list"),o.vc(5,z,6,3,"div",3),o.Qb(),o.Qb(),o.Rb(6,"mat-sidenav-content"),o.Mb(7,"router-outlet"),o.Qb(),o.Qb()),2&t&&(o.Ab(5),o.hc("ngForOf",e.menuOpciones))},directives:[X.b,X.a,u.a,Q.a,c.i,X.c,Y.e,Q.c,Y.b,h.a,Q.b,f.a],styles:["mat-sidenav-container[_ngcontent-%COMP%]{height:100%}mat-sidenav[_ngcontent-%COMP%]{width:20%}"]}),t})(),children:[{path:"",redirectTo:"facturas",pathMatch:"full"},{path:"facturas",component:H}]}];let I=(()=>{class t{}return t.\u0275mod=o.Jb({type:t}),t.\u0275inj=o.Ib({factory:function(e){return new(e||t)},imports:[[c.b,Y.d.forChild(Z),X.d,u.b,Q.d,h.b,m.b,p.b,g.e,w.l,i.c,R.b,b.b,s.b,d.b]]}),t})()}}]);