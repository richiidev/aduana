!function(){function o(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function r(o,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(o,t.key,t)}}function e(o,e,t){return e&&r(o.prototype,e),t&&r(o,t),o}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{JJEo:function(r,t,n){"use strict";n.r(t),n.d(t,"InicioPageModule",(function(){return k}));var i,s=n("ofXK"),a=n("3Pt+"),c=n("TEn/"),l=n("tyNb"),u=n("mrSG"),b=n("tk/3"),p=n("AytR"),m=n("fXoL"),d=n("lGQG"),f=((i=function(){function r(e,t,n,i){o(this,r),this.http=e,this.auth=t,this.toastCtrl=n,this.router=i}return e(r,[{key:"ngOnInit",value:function(){this.cargarForm()}},{key:"cargarForm",value:function(){this.loginForm=new a.c({rfc:new a.a(null,a.l.required),password:new a.a(null,[a.l.required,a.l.minLength(5)])})}},{key:"iniciarSesion",value:function(){var o=this,r=(new b.c).set("rfc",this.loginForm.value.rfc).set("password",this.loginForm.value.password);this.http.get(p.a.apiUrl+"/usuario/login",{params:r}).toPromise().then((function(r){if(1==r.data.length)switch(o.auth.usuario=r.data[0],localStorage.setItem("cuenta",JSON.stringify(o.auth.usuario)),o.mostrarToast("Bienvenido "+o.auth.usuario.nombre,"success"),o.auth.usuario.idrol.id){case 1:o.router.navigateByUrl("usuario",{replaceUrl:!0});break;case 2:o.router.navigateByUrl("admin",{replaceUrl:!0})}else o.mostrarToast("Error : datos incorrectos","danger");console.log("Resp al iniciar sesion",r)})).catch((function(r){o.mostrarToast("Error : datos incorrectos","danger"),console.log("Error al iniciar sesion",r)}))}},{key:"mostrarToast",value:function(o,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastCtrl.create({message:o,color:r,duration:3e3});case 2:return e.abrupt("return",e.sent.present());case 3:case"end":return e.stop()}}),e,this)})))}}]),r}()).\u0275fac=function(o){return new(o||i)(m.Hb(b.a),m.Hb(d.a),m.Hb(c.Q),m.Hb(l.f))},i.\u0275cmp=m.Bb({type:i,selectors:[["app-login"]],decls:24,vars:2,consts:[[1,"ion-text-center"],[2,"padding-left","10%","padding-right","10%"],[3,"formGroup","ngSubmit"],["position","floating"],["color","danger"],["formControlName","rfc","type","text"],["formControlName","password","type","password"],["mode","ios","expand","full","color","primary","type","submit",3,"disabled"]],template:function(o,r){1&o&&(m.Kb(0,"ion-header"),m.Kb(1,"ion-toolbar",0),m.Kb(2,"ion-title"),m.ec(3,"Autententiciacion"),m.Jb(),m.Jb(),m.Jb(),m.Kb(4,"ion-content"),m.Kb(5,"ion-card",1),m.Kb(6,"ion-card-header",0),m.Kb(7,"ion-card-title"),m.ec(8,"Ingresa tus datos"),m.Jb(),m.Jb(),m.Kb(9,"form",2),m.Sb("ngSubmit",(function(){return r.iniciarSesion()})),m.Kb(10,"ion-item"),m.Kb(11,"ion-label",3),m.ec(12,"RFC "),m.Kb(13,"ion-text",4),m.ec(14,"*"),m.Jb(),m.Jb(),m.Ib(15,"ion-input",5),m.Jb(),m.Kb(16,"ion-item"),m.Kb(17,"ion-label",3),m.ec(18,"Contrasena "),m.Kb(19,"ion-text",4),m.ec(20,"*"),m.Jb(),m.Jb(),m.Ib(21,"ion-input",6),m.Jb(),m.Kb(22,"ion-button",7),m.ec(23," Iniciar sesion "),m.Jb(),m.Jb(),m.Jb(),m.Jb()),2&o&&(m.xb(9),m.Xb("formGroup",r.loginForm),m.xb(13),m.Xb("disabled",r.loginForm.invalid))},directives:[c.o,c.H,c.G,c.k,c.f,c.h,c.i,a.m,a.i,a.d,c.r,c.s,c.F,c.q,c.P,a.h,a.b,c.d],styles:[""]}),i);function g(o,r){1&o&&(m.Kb(0,"p"),m.ec(1,"El RFC es necesario"),m.Jb())}function h(o,r){if(1&o&&(m.Kb(0,"ion-text",3),m.dc(1,g,2,0,"p",13),m.Kb(2,"p"),m.ec(3," El RFC "),m.Kb(4,"ion-badge",14),m.ec(5,"NO ESTA disponible"),m.Jb(),m.Jb(),m.Jb()),2&o){var e=m.Ub();m.xb(1),m.Xb("ngIf",(null==e.registroForm.controls.rfc.errors?null:e.registroForm.controls.rfc.errors.required)&&e.registroForm.controls.rfc.dirty)}}function J(o,r){1&o&&(m.Kb(0,"ion-text",15),m.Kb(1,"p"),m.ec(2," El RFC esta "),m.Kb(3,"ion-badge",16),m.ec(4,"DISPONIBLE"),m.Jb(),m.Jb(),m.Jb())}function K(o,r){1&o&&(m.Kb(0,"ion-text",3),m.Kb(1,"p"),m.ec(2,"Las contrase\xf1as NO son iguales"),m.Jb(),m.Jb())}var v,w,y,x,F=((v=function(){function r(e,t,n){o(this,r),this.http=e,this.toastCtrl=t,this.router=n}return e(r,[{key:"ngOnInit",value:function(){this.cargarFormulario()}},{key:"registrarce",value:function(){var o=this,r={nombre:this.registroForm.controls.nombre.value,apellidos:this.registroForm.controls.apellidos.value,correo:this.registroForm.controls.correo.value,rfc:this.registroForm.controls.rfc.value,password:this.registroForm.controls.password2.value,idrol:{id:1}};console.log("El usuario seria",r),this.http.post(p.a.apiUrl+"/usuario",r).subscribe((function(r){r.success?(o.mostrarToast("Se registro correctamente","success"),o.registroForm.reset({nombre:null,apellidos:null,correo:null,rfc:null,password:null,password2:null}),o.router.navigateByUrl("inicio/login")):o.mostrarToast("Algo salio mal","danger"),console.log("Resp al crear usuario",r)}),(function(o){return console.log("Ocurrio un error al crear el usuario",o)}))}},{key:"mostrarToast",value:function(o,r){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastCtrl.create({message:o,color:r,duration:3e3});case 2:return e.abrupt("return",e.sent.present());case 3:case"end":return e.stop()}}),e,this)})))}},{key:"rfcUnico",value:function(o){var r=this;return new Promise((function(o,e){r.http.get("".concat(p.a.apiUrl,"/usuario/rfcValidacion/?rfc=").concat(r.registroForm.controls.rfc.value)).subscribe((function(r){console.log("Se hizo bien",r),o(1==r.data.length?{existe:!0}:null)}),(function(r){console.log("Se hizo MAL",r),o({existe:!0})}))}))}},{key:"cargarFormulario",value:function(){this.registroForm=new a.c({nombre:new a.a(null,[a.l.required,a.l.minLength(6)]),apellidos:new a.a(null,[a.l.required,a.l.minLength(6)]),correo:new a.a(null,[a.l.required,a.l.minLength(6)]),rfc:new a.a(null,[a.l.required,a.l.minLength(4),a.l.maxLength(18),a.l.pattern("^[A-Z0-9_.-]*$")],this.rfcUnico.bind(this)),password:new a.a(null,[a.l.required,a.l.minLength(5)]),password2:new a.a(null,[a.l.required,a.l.min(5)])},{validators:this.compararContras})}},{key:"compararContras",value:function(o){return o.controls.password2.value===o.controls.password.value?null:{mismatch:!0}}}]),r}()).\u0275fac=function(o){return new(o||v)(m.Hb(b.a),m.Hb(c.Q),m.Hb(l.f))},v.\u0275cmp=m.Bb({type:v,selectors:[["app-signup"]],decls:48,vars:5,consts:[[1,"ion-text-center"],[3,"formGroup"],["position","floating"],["color","danger"],["required","","formControlName","nombre","type","text"],["required","","formControlName","apellidos","type","text"],["required","","formControlName","correo","type","text"],["debounce","1000","required","","formControlName","rfc","oninput","this.value = this.value.toUpperCase()","type","text"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["required","","formControlName","password","type","password"],["formControlName","password2","type","password"],["expand","full","color","primary",3,"disabled","click"],[4,"ngIf"],["color","danger","mode","ios"],["color","success"],["color","success","mode","ios"]],template:function(o,r){1&o&&(m.Kb(0,"ion-header"),m.Kb(1,"ion-toolbar",0),m.Kb(2,"ion-title"),m.ec(3,"Registro"),m.Jb(),m.Jb(),m.Jb(),m.Kb(4,"ion-content"),m.Kb(5,"ion-card"),m.Kb(6,"form",1),m.Kb(7,"ion-item"),m.Kb(8,"ion-label",2),m.ec(9,"Nombres "),m.Kb(10,"ion-text",3),m.ec(11,"*"),m.Jb(),m.Jb(),m.Ib(12,"ion-input",4),m.Jb(),m.Kb(13,"ion-item"),m.Kb(14,"ion-label",2),m.ec(15,"Apellidos "),m.Kb(16,"ion-text",3),m.ec(17,"*"),m.Jb(),m.Jb(),m.Ib(18,"ion-input",5),m.Jb(),m.Kb(19,"ion-item"),m.Kb(20,"ion-label",2),m.ec(21,"Correo electronico "),m.Kb(22,"ion-text",3),m.ec(23,"*"),m.Jb(),m.Jb(),m.Ib(24,"ion-input",6),m.Jb(),m.Kb(25,"ion-item"),m.Kb(26,"ion-label",2),m.ec(27,"RFC o numero de agente"),m.Kb(28,"ion-text",3),m.ec(29,"*"),m.Jb(),m.Jb(),m.Ib(30,"ion-input",7),m.dc(31,h,6,1,"ion-text",8),m.dc(32,J,5,0,"ion-text",9),m.Jb(),m.Kb(33,"ion-item"),m.Kb(34,"ion-label",2),m.ec(35,"Contrasena "),m.Kb(36,"ion-text",3),m.ec(37,"*"),m.Jb(),m.Jb(),m.Ib(38,"ion-input",10),m.Jb(),m.Kb(39,"ion-item"),m.Kb(40,"ion-label",2),m.ec(41,"Repite tu contrasena "),m.Kb(42,"ion-text",3),m.ec(43,"*"),m.Jb(),m.Jb(),m.Ib(44,"ion-input",11),m.dc(45,K,3,0,"ion-text",8),m.Jb(),m.Jb(),m.Kb(46,"ion-button",12),m.Sb("click",(function(){return r.registrarce()})),m.ec(47," Registrarce\n"),m.Jb(),m.Jb(),m.Jb()),2&o&&(m.xb(6),m.Xb("formGroup",r.registroForm),m.xb(25),m.Xb("ngIf",null==r.registroForm.controls.rfc.errors?null:r.registroForm.controls.rfc.errors.existe),m.xb(1),m.Xb("ngIf",r.registroForm.controls.rfc.valid),m.xb(13),m.Xb("ngIf",(null==r.registroForm.errors?null:r.registroForm.errors.mismatch)&&(r.registroForm.controls.password2.dirty||r.registroForm.controls.password2.touched)),m.xb(1),m.Xb("disabled",r.registroForm.invalid))},directives:[c.o,c.H,c.G,c.k,c.f,a.m,a.i,a.d,c.r,c.s,c.F,c.q,c.P,a.k,a.h,a.b,s.i,c.d,c.c],styles:[""]}),v),I=[{path:"",component:(w=function(){function r(){o(this,r)}return e(r,[{key:"ngOnInit",value:function(){}}]),r}(),w.\u0275fac=function(o){return new(o||w)},w.\u0275cmp=m.Bb({type:w,selectors:[["app-inicio"]],decls:10,vars:0,consts:[["slot","bottom,top"],["tab","login"],["name","person-circle"],["tab","signup"],["name","create"]],template:function(o,r){1&o&&(m.Kb(0,"ion-tabs"),m.Kb(1,"ion-tab-bar",0),m.Kb(2,"ion-tab-button",1),m.Ib(3,"ion-icon",2),m.Kb(4,"ion-label"),m.ec(5,"Iniciar sesion"),m.Jb(),m.Jb(),m.Kb(6,"ion-tab-button",3),m.Ib(7,"ion-icon",4),m.Kb(8,"ion-label"),m.ec(9,"Registrate"),m.Jb(),m.Jb(),m.Jb(),m.Jb())},directives:[c.E,c.C,c.D,c.p,c.s],styles:[""]}),w),children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:f},{path:"signup",component:F}]}],C=((x=function r(){o(this,r)}).\u0275mod=m.Fb({type:x}),x.\u0275inj=m.Eb({factory:function(o){return new(o||x)},imports:[[l.h.forChild(I)],l.h]}),x),k=((y=function r(){o(this,r)}).\u0275mod=m.Fb({type:y}),y.\u0275inj=m.Eb({factory:function(o){return new(o||y)},imports:[[s.b,a.e,c.J,a.j,b.b,C]]}),y)}}])}();