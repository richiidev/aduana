!function(){function r(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function o(r,o){for(var e=0;e<o.length;e++){var t=o[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function e(r,e,t){return e&&o(r.prototype,e),t&&o(r,t),r}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{JJEo:function(o,t,n){"use strict";n.r(t),n.d(t,"InicioPageModule",(function(){return k}));var i,s=n("ofXK"),a=n("3Pt+"),c=n("TEn/"),l=n("tyNb"),u=n("mrSG"),b=n("tk/3"),m=n("AytR"),p=n("fXoL"),d=n("lGQG"),f=((i=function(){function o(e,t,n,i){r(this,o),this.http=e,this.auth=t,this.toastCtrl=n,this.router=i}return e(o,[{key:"ngOnInit",value:function(){this.cargarForm()}},{key:"cargarForm",value:function(){this.loginForm=new a.c({rfc:new a.a(null,a.l.required),password:new a.a(null,[a.l.required,a.l.minLength(5)])})}},{key:"iniciarSesion",value:function(){var r=this,o=(new b.c).set("rfc",this.loginForm.value.rfc).set("password",this.loginForm.value.password);this.http.get(m.a.apiUrl+"/usuario/login",{params:o}).toPromise().then((function(o){if(1==o.data.length)switch(r.auth.usuario=o.data[0],localStorage.setItem("cuenta",JSON.stringify(r.auth.usuario)),r.mostrarToast("Bienvenido "+r.auth.usuario.nombre,"success"),r.auth.usuario.idrol.id){case 1:r.router.navigateByUrl("admin",{replaceUrl:!0});break;case 2:r.router.navigateByUrl("usuario",{replaceUrl:!0})}else r.mostrarToast("Error : datos incorrectos","danger");console.log("Resp al iniciar sesion",o)})).catch((function(o){r.mostrarToast("Error : datos incorrectos","danger"),console.log("Error al iniciar sesion",o)}))}},{key:"mostrarToast",value:function(r,o){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastCtrl.create({message:r,color:o,duration:3e3});case 2:return e.abrupt("return",e.sent.present());case 3:case"end":return e.stop()}}),e,this)})))}}]),o}()).\u0275fac=function(r){return new(r||i)(p.Hb(b.a),p.Hb(d.a),p.Hb(c.Q),p.Hb(l.f))},i.\u0275cmp=p.Bb({type:i,selectors:[["app-login"]],decls:24,vars:2,consts:[[1,"ion-text-center"],[2,"padding-left","10%","padding-right","10%"],[3,"formGroup","ngSubmit"],["position","floating"],["color","danger"],["formControlName","rfc","type","text"],["formControlName","password","type","password"],["mode","ios","expand","full","color","primary","type","submit",3,"disabled"]],template:function(r,o){1&r&&(p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-title"),p.ec(3,"Autententiciacion"),p.Jb(),p.Jb(),p.Jb(),p.Kb(4,"ion-content"),p.Kb(5,"ion-card",1),p.Kb(6,"ion-card-header",0),p.Kb(7,"ion-card-title"),p.ec(8,"Ingresa tus datos"),p.Jb(),p.Jb(),p.Kb(9,"form",2),p.Sb("ngSubmit",(function(){return o.iniciarSesion()})),p.Kb(10,"ion-item"),p.Kb(11,"ion-label",3),p.ec(12,"RFC "),p.Kb(13,"ion-text",4),p.ec(14,"*"),p.Jb(),p.Jb(),p.Ib(15,"ion-input",5),p.Jb(),p.Kb(16,"ion-item"),p.Kb(17,"ion-label",3),p.ec(18,"Contrasena "),p.Kb(19,"ion-text",4),p.ec(20,"*"),p.Jb(),p.Jb(),p.Ib(21,"ion-input",6),p.Jb(),p.Kb(22,"ion-button",7),p.ec(23," Iniciar sesion "),p.Jb(),p.Jb(),p.Jb(),p.Jb()),2&r&&(p.xb(9),p.Xb("formGroup",o.loginForm),p.xb(13),p.Xb("disabled",o.loginForm.invalid))},directives:[c.o,c.H,c.G,c.k,c.f,c.h,c.i,a.m,a.i,a.d,c.r,c.s,c.F,c.q,c.P,a.h,a.b,c.d],styles:[""]}),i);function g(r,o){1&r&&(p.Kb(0,"p"),p.ec(1,"El RFC es necesario"),p.Jb())}function h(r,o){if(1&r&&(p.Kb(0,"ion-text",3),p.dc(1,g,2,0,"p",13),p.Kb(2,"p"),p.ec(3," El RFC "),p.Kb(4,"ion-badge",14),p.ec(5,"NO ESTA disponible"),p.Jb(),p.Jb(),p.Jb()),2&r){var e=p.Ub();p.xb(1),p.Xb("ngIf",(null==e.registroForm.controls.rfc.errors?null:e.registroForm.controls.rfc.errors.required)&&e.registroForm.controls.rfc.dirty)}}function J(r,o){1&r&&(p.Kb(0,"ion-text",15),p.Kb(1,"p"),p.ec(2," El RFC esta "),p.Kb(3,"ion-badge",16),p.ec(4,"DISPONIBLE"),p.Jb(),p.Jb(),p.Jb())}function K(r,o){1&r&&(p.Kb(0,"ion-text",3),p.Kb(1,"p"),p.ec(2,"Las contrase\xf1as NO son iguales"),p.Jb(),p.Jb())}var v,w,y,x,F=((v=function(){function o(e,t,n){r(this,o),this.http=e,this.toastCtrl=t,this.router=n}return e(o,[{key:"ngOnInit",value:function(){this.cargarFormulario()}},{key:"registrarce",value:function(){var r=this,o={nombre:this.registroForm.controls.nombre.value,apellidos:this.registroForm.controls.apellidos.value,correo:this.registroForm.controls.correo.value,rfc:this.registroForm.controls.rfc.value,password:this.registroForm.controls.password2.value,idrol:{id:2}};console.log("El usuario seria",o),this.http.post(m.a.apiUrl+"/usuario",o).subscribe((function(o){o.success?(r.mostrarToast("Se registro correctamente","success"),r.registroForm.reset({nombre:null,apellidos:null,correo:null,rfc:null,password:null,password2:null}),r.router.navigateByUrl("inicio/login")):r.mostrarToast("Algo salio mal","danger"),console.log("Resp al crear usuario",o)}),(function(r){return console.log("Ocurrio un error al crear el usuario",r)}))}},{key:"mostrarToast",value:function(r,o){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toastCtrl.create({message:r,color:o,duration:3e3});case 2:return e.abrupt("return",e.sent.present());case 3:case"end":return e.stop()}}),e,this)})))}},{key:"rfcUnico",value:function(r){var o=this;return new Promise((function(r,e){return Object(u.a)(o,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.http.get("".concat(m.a.apiUrl,"/usuario/rfc/?rfc=").concat(this.registroForm.controls.rfc.value)).subscribe((function(o){console.log("Se hizo bien",o),r(1==o.data.length?{existe:!0}:null)}),(function(o){console.log("Se hizo MAL",o),r({existe:!0})}));case 2:case"end":return o.stop()}}),o,this)})))}))}},{key:"cargarFormulario",value:function(){this.registroForm=new a.c({nombre:new a.a(null,[a.l.required,a.l.minLength(6)]),apellidos:new a.a(null,[a.l.required,a.l.minLength(6)]),correo:new a.a(null,[a.l.required,a.l.minLength(6)]),rfc:new a.a(null,[a.l.required,a.l.minLength(6)],this.rfcUnico.bind(this)),password:new a.a(null,[a.l.required,a.l.minLength(5)]),password2:new a.a(null,[a.l.required,a.l.min(5)])},{validators:this.compararContras})}},{key:"compararContras",value:function(r){return r.controls.password2.value===r.controls.password.value?null:{mismatch:!0}}}]),o}()).\u0275fac=function(r){return new(r||v)(p.Hb(b.a),p.Hb(c.Q),p.Hb(l.f))},v.\u0275cmp=p.Bb({type:v,selectors:[["app-signup"]],decls:48,vars:5,consts:[[1,"ion-text-center"],[3,"formGroup"],["position","floating"],["color","danger"],["required","","formControlName","nombre","type","text"],["required","","formControlName","apellidos","type","text"],["required","","formControlName","correo","type","text"],["debounce","1000","required","","formControlName","rfc","type","text"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["required","","formControlName","password","type","password"],["formControlName","password2","type","password"],["expand","full","color","primary",3,"disabled","click"],[4,"ngIf"],["color","danger","mode","ios"],["color","success"],["color","success","mode","ios"]],template:function(r,o){1&r&&(p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-title"),p.ec(3,"Registro"),p.Jb(),p.Jb(),p.Jb(),p.Kb(4,"ion-content"),p.Kb(5,"ion-card"),p.Kb(6,"form",1),p.Kb(7,"ion-item"),p.Kb(8,"ion-label",2),p.ec(9,"Nombres "),p.Kb(10,"ion-text",3),p.ec(11,"*"),p.Jb(),p.Jb(),p.Ib(12,"ion-input",4),p.Jb(),p.Kb(13,"ion-item"),p.Kb(14,"ion-label",2),p.ec(15,"Apellidos "),p.Kb(16,"ion-text",3),p.ec(17,"*"),p.Jb(),p.Jb(),p.Ib(18,"ion-input",5),p.Jb(),p.Kb(19,"ion-item"),p.Kb(20,"ion-label",2),p.ec(21,"Correo electronico "),p.Kb(22,"ion-text",3),p.ec(23,"*"),p.Jb(),p.Jb(),p.Ib(24,"ion-input",6),p.Jb(),p.Kb(25,"ion-item"),p.Kb(26,"ion-label",2),p.ec(27,"RFC "),p.Kb(28,"ion-text",3),p.ec(29,"*"),p.Jb(),p.Jb(),p.Ib(30,"ion-input",7),p.dc(31,h,6,1,"ion-text",8),p.dc(32,J,5,0,"ion-text",9),p.Jb(),p.Kb(33,"ion-item"),p.Kb(34,"ion-label",2),p.ec(35,"Contrasena "),p.Kb(36,"ion-text",3),p.ec(37,"*"),p.Jb(),p.Jb(),p.Ib(38,"ion-input",10),p.Jb(),p.Kb(39,"ion-item"),p.Kb(40,"ion-label",2),p.ec(41,"Repite tu contrasena "),p.Kb(42,"ion-text",3),p.ec(43,"*"),p.Jb(),p.Jb(),p.Ib(44,"ion-input",11),p.dc(45,K,3,0,"ion-text",8),p.Jb(),p.Jb(),p.Kb(46,"ion-button",12),p.Sb("click",(function(){return o.registrarce()})),p.ec(47," Registrarce\n"),p.Jb(),p.Jb(),p.Jb()),2&r&&(p.xb(6),p.Xb("formGroup",o.registroForm),p.xb(25),p.Xb("ngIf",null==o.registroForm.controls.rfc.errors?null:o.registroForm.controls.rfc.errors.existe),p.xb(1),p.Xb("ngIf",o.registroForm.controls.rfc.valid),p.xb(13),p.Xb("ngIf",(null==o.registroForm.errors?null:o.registroForm.errors.mismatch)&&(o.registroForm.controls.password2.dirty||o.registroForm.controls.password2.touched)),p.xb(1),p.Xb("disabled",o.registroForm.invalid))},directives:[c.o,c.H,c.G,c.k,c.f,a.m,a.i,a.d,c.r,c.s,c.F,c.q,c.P,a.k,a.h,a.b,s.i,c.d,c.c],styles:[""]}),v),I=[{path:"",component:(w=function(){function o(){r(this,o)}return e(o,[{key:"ngOnInit",value:function(){}}]),o}(),w.\u0275fac=function(r){return new(r||w)},w.\u0275cmp=p.Bb({type:w,selectors:[["app-inicio"]],decls:10,vars:0,consts:[["slot","bottom,top"],["tab","login"],["name","person-circle"],["tab","signup"],["name","create"]],template:function(r,o){1&r&&(p.Kb(0,"ion-tabs"),p.Kb(1,"ion-tab-bar",0),p.Kb(2,"ion-tab-button",1),p.Ib(3,"ion-icon",2),p.Kb(4,"ion-label"),p.ec(5,"Iniciar sesion"),p.Jb(),p.Jb(),p.Kb(6,"ion-tab-button",3),p.Ib(7,"ion-icon",4),p.Kb(8,"ion-label"),p.ec(9,"Registrate"),p.Jb(),p.Jb(),p.Jb(),p.Jb())},directives:[c.E,c.C,c.D,c.p,c.s],styles:[""]}),w),children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:f},{path:"signup",component:F}]}],C=((x=function o(){r(this,o)}).\u0275mod=p.Fb({type:x}),x.\u0275inj=p.Eb({factory:function(r){return new(r||x)},imports:[[l.h.forChild(I)],l.h]}),x),k=((y=function o(){r(this,o)}).\u0275mod=p.Fb({type:y}),y.\u0275inj=p.Eb({factory:function(r){return new(r||y)},imports:[[s.b,a.e,c.J,a.j,b.b,C]]}),y)}}])}();