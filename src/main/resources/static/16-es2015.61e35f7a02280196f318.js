(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"0NIx":function(e,o,t){"use strict";t.r(o),t.d(o,"UsuarioPageModule",(function(){return k}));var c=t("ofXK"),i=t("3Pt+"),n=t("TEn/"),a=t("tyNb"),r=t("mrSG"),s=t("AytR"),l=t("fXoL"),b=t("tk/3"),u=t("lGQG");function h(e,o){if(1&e&&(l.Kb(0,"p"),l.gc(1),l.Vb(2,"date"),l.Jb()),2&e){const e=l.Ub();l.xb(1),l.hc(l.Wb(2,1,e.fechaInicio))}}function d(e,o){if(1&e&&(l.Kb(0,"p"),l.gc(1),l.Vb(2,"date"),l.Jb()),2&e){const e=l.Ub();l.xb(1),l.hc(l.Wb(2,1,e.fechaFinal))}}function f(e,o){if(1&e){const e=l.Lb();l.Kb(0,"ion-item"),l.Kb(1,"ion-checkbox",11),l.Sb("ngModelChange",(function(t){return l.cc(e),o.$implicit.check=t})),l.Jb(),l.Kb(2,"ion-label"),l.gc(3," RFC "),l.Kb(4,"p"),l.gc(5),l.Jb(),l.Jb(),l.Kb(6,"ion-label"),l.gc(7," Agente "),l.Kb(8,"p"),l.gc(9),l.Jb(),l.Jb(),l.Kb(10,"ion-label"),l.gc(11," Factura "),l.Kb(12,"p"),l.gc(13),l.Jb(),l.Jb(),l.Kb(14,"ion-label"),l.gc(15," pedimento "),l.Kb(16,"p"),l.gc(17),l.Jb(),l.Jb(),l.Kb(18,"ion-label"),l.gc(19," Fecha "),l.Kb(20,"p"),l.gc(21),l.Jb(),l.Jb(),l.Jb()}if(2&e){const e=o.$implicit;l.xb(1),l.Zb("ngModel",e.check),l.xb(4),l.ic(" ",e.rfc," "),l.xb(4),l.ic(" ",e.agente," "),l.xb(4),l.ic(" ",e.factura," "),l.xb(4),l.ic(" ",e.pedimento," "),l.xb(4),l.ic(" ",e.fecha," ")}}let p=(()=>{class e{constructor(e,o,t,c){this.http=e,this.auth=o,this.actionSheetController=t,this.toastCtrl=c,this.seleccionados=[],this.fechaInicio="",this.fechaFinal=""}ngOnInit(){this.pagoPeticion()}setFechaInicio(e){console.log("la fecha inicio es",e),this.fechaInicio=e}setFechaFinal(e){console.log("la fecha final es",e),this.fechaFinal=e}seleccionar(){this.pagos.forEach((e,o)=>{e.check&&this.seleccionados.push({index:o,factura:e.factura})}),1==this.seleccionados.length?this.mostrarOpcionesIndividual(this.seleccionados[0].index):this.mostrarOpcionesMultiple(),console.log("Seleccionados",this.seleccionados)}mostrarOpcionesMultiple(){return Object(r.b)(this,void 0,void 0,(function*(){const e=yield this.actionSheetController.create({header:"Que deseas hacer con las facturas seleccionadas : ",cssClass:"my-custom-class",buttons:[{text:"Descargar xml y pdf seleccionados",icon:"cloud-download",handler:()=>{}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield e.present()}))}mostrarOpcionesIndividual(e){return Object(r.b)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.pagos[e].rfc+", Agente: "+this.pagos[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:()=>{this.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:()=>{this.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield o.present()}))}pagoPeticion(){this.http.get(`${s.a.apiUrl}/pagos/rfc?rfc=${this.auth.usuario.rfc}`).subscribe(e=>{e.data.length>0?this.pagos=e.data:this.mostrarToast("No se encontro ninguna","danger"),console.log("Resp de las peticion",e)},e=>{console.log("Error al buscar pagos",e)})}mostrarOpciones(e){return Object(r.b)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.pagos[e].rfc+", Agente: "+this.pagos[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:()=>{this.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:()=>{this.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield o.present()}))}abrirArchivo(e,o){var t=document.createElement("a");t.href=`${s.a.apiFile}/file/${this.pagos[e].factura}.${o}`,t.setAttribute("target","_blank"),t.click(),t.remove()}mostrarToast(e,o){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield this.toastCtrl.create({message:e,color:o,duration:3e3});yield t.present()}))}}return e.\u0275fac=function(o){return new(o||e)(l.Hb(b.a),l.Hb(u.a),l.Hb(n.a),l.Hb(n.T))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-buscar-pagos"]],decls:26,vars:3,consts:[["color","primary",1,"ion-text-center"],["display-format","YYYY-MM-DD",2,"display","none",3,"ionChange"],["fechasInicio",""],["fechasFinal",""],["size","6"],["expand","block","color","dark",3,"click"],["name","checkbox-outline"],["color","danger","expand","block",3,"click"],[4,"ngIf"],[3,"items"],[4,"virtualItem"],[3,"ngModel","ngModelChange"]],template:function(e,o){if(1&e){const e=l.Lb();l.Kb(0,"ion-header"),l.Kb(1,"ion-toolbar",0),l.Kb(2,"ion-title"),l.gc(3,"Mis pagos"),l.Jb(),l.Kb(4,"ion-datetime",1,2),l.Sb("ionChange",(function(e){return o.setFechaInicio(e.target.value)})),l.Jb(),l.Kb(6,"ion-datetime",1,3),l.Sb("ionChange",(function(e){return o.setFechaFinal(e.target.value)})),l.Jb(),l.Kb(8,"ion-row"),l.Kb(9,"ion-col",4),l.Kb(10,"ion-button",5),l.Sb("click",(function(){return o.seleccionar()})),l.Ib(11,"ion-icon",6),l.gc(12," Opciones de pago 's' seleccionada 's' "),l.Jb(),l.Jb(),l.Kb(13,"ion-col",4),l.Kb(14,"ion-row"),l.Kb(15,"ion-col",4),l.Kb(16,"ion-button",7),l.Sb("click",(function(){return l.cc(e),l.bc(5).open()})),l.gc(17," Fecha de inicio "),l.Jb(),l.fc(18,h,3,3,"p",8),l.Jb(),l.Kb(19,"ion-col",4),l.Kb(20,"ion-button",7),l.Sb("click",(function(){return l.cc(e),l.bc(7).open()})),l.gc(21," Fecha final "),l.Jb(),l.fc(22,d,3,3,"p",8),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Kb(23,"ion-content"),l.Kb(24,"ion-virtual-scroll",9),l.fc(25,f,22,6,"ion-item",10),l.Jb(),l.Jb()}2&e&&(l.xb(18),l.Zb("ngIf",""!=o.fechaInicio),l.xb(4),l.Zb("ngIf",""!=o.fechaFinal),l.xb(2),l.Zb("items",o.pagos))},directives:[n.r,n.K,n.J,n.o,n.R,n.A,n.m,n.f,n.s,c.j,n.n,n.L,n.U,n.u,n.l,n.c,i.i,i.k,n.v],pipes:[c.d],styles:["ion-item[_ngcontent-%COMP%]{--background:#a3a3a3}"]}),e})();function g(e,o){if(1&e&&(l.Kb(0,"p"),l.gc(1),l.Vb(2,"date"),l.Jb()),2&e){const e=l.Ub();l.xb(1),l.hc(l.Wb(2,1,e.fechaInicio))}}function m(e,o){if(1&e&&(l.Kb(0,"p"),l.gc(1),l.Vb(2,"date"),l.Jb()),2&e){const e=l.Ub();l.xb(1),l.hc(l.Wb(2,1,e.fechaFinal))}}function J(e,o){if(1&e){const e=l.Lb();l.Kb(0,"ion-item"),l.Kb(1,"ion-checkbox",11),l.Sb("ngModelChange",(function(t){return l.cc(e),o.$implicit.check=t})),l.Jb(),l.Kb(2,"ion-label"),l.gc(3," RFC "),l.Kb(4,"p"),l.gc(5),l.Jb(),l.Jb(),l.Kb(6,"ion-label"),l.gc(7," Agente "),l.Kb(8,"p"),l.gc(9),l.Jb(),l.Jb(),l.Kb(10,"ion-label"),l.gc(11," Factura "),l.Kb(12,"p"),l.gc(13),l.Jb(),l.Jb(),l.Kb(14,"ion-label"),l.gc(15," pedimento "),l.Kb(16,"p"),l.gc(17),l.Jb(),l.Jb(),l.Kb(18,"ion-label"),l.gc(19," Fecha "),l.Kb(20,"p"),l.gc(21),l.Jb(),l.Jb(),l.Jb()}if(2&e){const e=o.$implicit;l.xb(1),l.Zb("ngModel",e.check),l.xb(4),l.ic(" ",e.rfc," "),l.xb(4),l.ic(" ",e.agente," "),l.xb(4),l.ic(" ",e.factura," "),l.xb(4),l.ic(" ",e.pedimento," "),l.xb(4),l.ic(" ",e.fecha," ")}}let K=(()=>{class e{constructor(e,o,t,c){this.http=e,this.toastCtrl=o,this.auth=t,this.actionSheetController=c,this.facturas=void 0,this.seleccionados=[],this.fechaInicio="",this.fechaFinal=""}ngOnInit(){this.peticionFactura()}setFechaInicio(e){console.log("la fecha inicio es",e),this.fechaInicio=e}setFechaFinal(e){console.log("la fecha final es",e),this.fechaFinal=e}seleccionar(){this.facturas.forEach((e,o)=>{e.check&&this.seleccionados.push({index:o,factura:e.factura})}),1==this.seleccionados.length?this.mostrarOpcionesIndividual(this.seleccionados[0].index):this.mostrarOpcionesMultiple(),console.log("Seleccionados",this.seleccionados)}descargarZip(){let e=[];this.seleccionados.forEach(o=>{e.push("C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\"+o.factura+".xml"),e.push("C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\"+o.factura+".pdf")});const o=(new Date).toISOString();this.http.post(`${s.a.apiUrl}/zip?zipFile=C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\${o}`,e).toPromise().then(e=>{console.log("Resp de hacer zip archivos",e),e.success&&this.descargar(o)}).catch(e=>{console.log("Error al comprimir archios",e),this.mostrarToast("Error al descargar el zip","danger")})}descargar(e){var o=document.createElement("a");o.href=`${s.a.apiFile}/file/${e}`,o.setAttribute("target","download"),o.click(),o.remove()}mostrarOpcionesMultiple(){return Object(r.b)(this,void 0,void 0,(function*(){const e=yield this.actionSheetController.create({header:"Que deseas hacer con las facturas seleccionadas : ",cssClass:"my-custom-class",buttons:[{text:"Descargar xml y pdf seleccionados",icon:"cloud-download",handler:()=>{this.descargarZip()}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield e.present()}))}mostrarOpcionesIndividual(e){return Object(r.b)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.facturas[e].rfc+", Agente: "+this.facturas[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:()=>{this.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:()=>{this.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield o.present()}))}abrirArchivo(e,o){const t=document.createElement("a");t.href=`${s.a.apiFile}/file/${this.facturas[e].factura}.${o}`,t.setAttribute("target","_blank"),t.click(),t.remove()}peticionFactura(){this.http.get(`${s.a.apiUrl}/facturas?rfc=${this.auth.usuario.rfc}`).subscribe(e=>{console.log("Resp de buscar factura",e),e.data.length>0?(this.facturas=e.data,this.mostrarToast("Se encontraron","success")):this.mostrarToast("No se encotraron","danger")},e=>{console.log("Error al buscar la factura",e)})}mostrarToast(e,o){return Object(r.b)(this,void 0,void 0,(function*(){const t=yield this.toastCtrl.create({message:e,color:o,duration:3e3});yield t.present()}))}}return e.\u0275fac=function(o){return new(o||e)(l.Hb(b.a),l.Hb(n.T),l.Hb(u.a),l.Hb(n.a))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-buscar-facturas"]],decls:26,vars:3,consts:[["color","primary",1,"ion-text-center"],["display-format","YYYY-MM-DD",2,"display","none",3,"ionChange"],["fechasInicio",""],["fechasFinal",""],["size","6"],["expand","block","color","dark",3,"click"],["name","checkbox-outline"],["color","danger","expand","block",3,"click"],[4,"ngIf"],[3,"items"],[4,"virtualItem"],[3,"ngModel","ngModelChange"]],template:function(e,o){if(1&e){const e=l.Lb();l.Kb(0,"ion-header"),l.Kb(1,"ion-toolbar",0),l.Kb(2,"ion-title"),l.gc(3,"Mis facturas"),l.Jb(),l.Kb(4,"ion-datetime",1,2),l.Sb("ionChange",(function(e){return o.setFechaInicio(e.target.value)})),l.Jb(),l.Kb(6,"ion-datetime",1,3),l.Sb("ionChange",(function(e){return o.setFechaFinal(e.target.value)})),l.Jb(),l.Kb(8,"ion-row"),l.Kb(9,"ion-col",4),l.Kb(10,"ion-button",5),l.Sb("click",(function(){return o.seleccionar()})),l.Ib(11,"ion-icon",6),l.gc(12," Opciones Factura 's' seleccionada 's' "),l.Jb(),l.Jb(),l.Kb(13,"ion-col",4),l.Kb(14,"ion-row"),l.Kb(15,"ion-col",4),l.Kb(16,"ion-button",7),l.Sb("click",(function(){return l.cc(e),l.bc(5).open()})),l.gc(17," Fecha de inicio "),l.Jb(),l.fc(18,g,3,3,"p",8),l.Jb(),l.Kb(19,"ion-col",4),l.Kb(20,"ion-button",7),l.Sb("click",(function(){return l.cc(e),l.bc(7).open()})),l.gc(21," Fecha final "),l.Jb(),l.fc(22,m,3,3,"p",8),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Kb(23,"ion-content"),l.Kb(24,"ion-virtual-scroll",9),l.fc(25,J,22,6,"ion-item",10),l.Jb(),l.Jb()}2&e&&(l.xb(18),l.Zb("ngIf",""!=o.fechaInicio),l.xb(4),l.Zb("ngIf",""!=o.fechaFinal),l.xb(2),l.Zb("items",o.facturas))},directives:[n.r,n.K,n.J,n.o,n.R,n.A,n.m,n.f,n.s,c.j,n.n,n.L,n.U,n.u,n.l,n.c,i.i,i.k,n.v],pipes:[c.d],styles:["ion-item[_ngcontent-%COMP%]{--background:#a3a3a3;--background-activated:#07f}"]}),e})();function x(e,o){if(1&e&&(l.Kb(0,"ion-item",10),l.Kb(1,"ion-label"),l.gc(2),l.Jb(),l.Ib(3,"ion-icon",11),l.Jb()),2&e){const e=o.$implicit,t=l.Ub();l.zb("active-item",t.selectedPath.startsWith(e.url)),l.Zb("routerLink",e.url),l.xb(2),l.ic(" ",e.titulo," "),l.xb(1),l.Zb("name",e.icon)}}const v=[{path:"",component:(()=>{class e{constructor(e,o){this.auth=e,this.router=o,this.selectedPath="",this.usuarioPages=[{titulo:"Mis facturas",icon:"newspaper",url:"/usuario/facturas"},{titulo:"Mis pagos",icon:"cash",url:"/usuario/pagos"}]}ngOnInit(){this.router.events.subscribe(e=>{e&&e.url&&(this.selectedPath=e.url)})}}return e.\u0275fac=function(o){return new(o||e)(l.Hb(u.a),l.Hb(a.f))},e.\u0275cmp=l.Bb({type:e,selectors:[["app-usuario"]],decls:19,vars:3,consts:[["contentId","menu-admins"],["menuId","menu-admins","contentId","menu-admins","side","start","type","overlay"],["color","secondary",1,"ion-text-center"],[1,"ion-text-center"],["auto-hide","false"],["routerDirection","forward","class","menuContent",3,"routerLink","active-item",4,"ngFor","ngForOf"],[2,"text-align","center"],["color","danger","mode","ios","fill","solid","shape","round",3,"click"],["name","log-out"],["id","menu-admins"],["routerDirection","forward",1,"menuContent",3,"routerLink"],["mode","ios",3,"name"]],template:function(e,o){1&e&&(l.Kb(0,"ion-split-pane",0),l.Kb(1,"ion-menu",1),l.Kb(2,"ion-header"),l.Kb(3,"ion-toolbar",2),l.Kb(4,"ion-title"),l.gc(5,"Modulo de usuarios"),l.Jb(),l.Kb(6,"ion-card"),l.Kb(7,"ion-card-header"),l.Kb(8,"ion-card-title"),l.gc(9),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Kb(10,"ion-content",3),l.Kb(11,"ion-list"),l.Kb(12,"ion-menu-toggle",4),l.fc(13,x,4,5,"ion-item",5),l.Jb(),l.Kb(14,"ion-item",6),l.Kb(15,"ion-button",7),l.Sb("click",(function(){return o.auth.cerrarSesion()})),l.gc(16," Cerrar sesion "),l.Ib(17,"ion-icon",8),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Jb(),l.Ib(18,"ion-router-outlet",9),l.Jb()),2&e&&(l.xb(9),l.jc("",null==o.auth||null==o.auth.usuario?null:o.auth.usuario.nombre," ",null==o.auth||null==o.auth.usuario?null:o.auth.usuario.apellidos,""),l.xb(4),l.Zb("ngForOf",o.usuarioPages))},directives:[n.E,n.x,n.r,n.K,n.J,n.h,n.j,n.k,n.n,n.w,n.y,c.i,n.u,n.f,n.s,n.z,n.Q,a.g,n.v],styles:[".active-item[_ngcontent-%COMP%]{border-left:8px solid var(--ion-color-primary)}"]}),e})(),children:[{path:"",redirectTo:"facturas",pathMatch:"full"},{path:"facturas",component:K},{path:"pagos",component:p}]}];let F=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(o){return new(o||e)},imports:[[a.h.forChild(v)],a.h]}),e})(),k=(()=>{class e{}return e.\u0275mod=l.Fb({type:e}),e.\u0275inj=l.Eb({factory:function(o){return new(o||e)},imports:[[c.b,i.f,n.M,F,b.b]]}),e})()}}]);