(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"R+XL":function(t,e,a){"use strict";a.r(e),a.d(e,"MY_DATE_FORMATS",(function(){return G})),a.d(e,"AgenteModule",(function(){return K}));var c=a("ofXK"),n=a("0EQZ"),r=a("S2gQ"),i=a("AytR"),o=a("fXoL"),b=a("tk/3"),s=a("dNgK"),l=a("lGQG"),u=a("/t3+"),d=a("bTqV"),m=a("STbY"),f=a("NFeN"),h=a("f0Cb"),p=a("vxfF"),g=a("+0xr"),S=a("bSwM"),R=a("MutI");function w(t,e){1&t&&o.Nb(0,"tr",24)}function x(t,e){1&t&&o.Nb(0,"tr",25)}function M(t,e){if(1&t){const t=o.Tb();o.Sb(0,"th",26),o.Sb(1,"mat-checkbox",27),o.Zb("change",(function(e){o.oc(t);const a=o.dc();return e?a.masterToggle():null})),o.Rb(),o.Rb()}if(2&t){const t=o.dc();o.Bb(1),o.ic("checked",t.selection.hasValue()&&t.isAllSelected())("indeterminate",t.selection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function k(t,e){if(1&t){const t=o.Tb();o.Sb(0,"td",28),o.Sb(1,"mat-checkbox",29),o.Zb("click",(function(e){return o.oc(t),e.stopPropagation()}))("change",(function(a){o.oc(t);const c=e.$implicit,n=o.dc();return a?n.selection.toggle(c):null})),o.Rb(),o.Rb()}if(2&t){const t=e.$implicit,a=o.dc();o.Bb(1),o.ic("checked",a.selection.isSelected(t))("aria-label",a.checkboxLabel(t))}}function v(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"Factura"),o.Rb())}function P(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.factura)}}function C(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"RFC"),o.Rb())}function D(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.rfc)}}function y(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"AWB"),o.Rb())}function $(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.awb)}}function B(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"HBW"),o.Rb())}function _(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.hbw)}}function F(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"Pedimento"),o.Rb())}function O(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.pedimento)}}function T(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"Fecha"),o.Rb())}function Z(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.fecha)}}function N(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"Agente"),o.Rb())}function j(t,e){if(1&t&&(o.Sb(0,"td",28),o.xc(1),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.yc(t.agente)}}function A(t,e){1&t&&(o.Sb(0,"th",26),o.xc(1,"Opciones"),o.Rb())}function z(t,e){if(1&t){const t=o.Tb();o.Sb(0,"td",28),o.Sb(1,"button",30),o.Zb("click",(function(){o.oc(t);const a=e.$implicit;return o.dc().abrirSeleccionado(a.factura,"pdf")})),o.Sb(2,"mat-icon",31),o.xc(3," picture_as_pdf "),o.Rb(),o.Rb(),o.Sb(4,"button",30),o.Zb("click",(function(){o.oc(t);const a=e.$implicit;return o.dc().abrirSeleccionado(a.factura,"xml")})),o.Sb(5,"mat-icon",31),o.xc(6," code "),o.Rb(),o.Rb(),o.Sb(7,"button",30),o.Zb("click",(function(){o.oc(t);const a=e.$implicit;return o.dc().descargarIndividual(a.factura)})),o.Sb(8,"mat-icon",31),o.xc(9," get_app"),o.Rb(),o.Rb(),o.Rb()}}let E=(()=>{class t{constructor(t,e,a){this.http=t,this.mensajeCtrl=e,this.auth=a,this.selection=new n.c(!0,[]),this.displayedColumnsPrueba=["select","factura","rfc","awb","hbw","pedimento","fecha","agente","opciones"],this.facturaTabla=new r.b([])}ngOnInit(){this.cargarFacturas()}cargarFacturas(){this.http.get(`${i.a.apiUrl}/facturas/agente?agente=${this.auth.usuario.rfc}`).subscribe(t=>{t.data.length>0?(this.facturaTabla=new r.b(t.data),this.mostrarMensaje("Se encontraron","snackVerde")):this.mostrarMensaje("No se encotraron","snackRojo")},t=>{})}descargarXmls(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".xml")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}descargarPdfs(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".pdf")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}descargarIndividual(t){const e=[t+".xml",t+".pdf"],a=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(a,e)}isAllSelected(){return this.selection.selected.length===this.facturaTabla.data.length}masterToggle(){this.isAllSelected()?this.selection.clear():this.facturaTabla.data.forEach(t=>this.selection.select(t))}checkboxLabel(t){return t?`${this.selection.isSelected(t)?"deselect":"select"} row ${t.position+1}`:(this.isAllSelected()?"select":"deselect")+" all"}mostrarMensaje(t,e){this.mensajeCtrl.open(t,null,{duration:3e3,verticalPosition:"bottom",panelClass:[e]})}descargarPdfsYXmls(){let t=[];this.selection.selected.forEach(e=>{t.push(e.factura+".pdf"),t.push(e.factura+".xml")});const e=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);this.generarZip(e,t)}generarZip(t,e){this.http.post(`${i.a.apiUrl}/crearZip?zipFile=${t}`,e).toPromise().then(e=>{e.success?this.descargarZip(t):this.mostrarMensaje("Error al descargar el zip","snackRojo")}).catch(t=>{this.mostrarMensaje("Error al descargar el zip","snackRojo")})}descargarZip(t){var e=document.createElement("a");e.href=`${i.a.apiFile}/file/${t}.zip`,e.download=t,e.click(),e.remove();const a=setInterval(()=>{this.http.get(`${i.a.apiUrl}/borrarArchivo?url=${t}.zip`).toPromise().then(t=>{}).catch(t=>{}),clearInterval(a)},5e3)}abrirSeleccionado(t,e){var a=document.createElement("a");a.href=`${i.a.apiFile}/file/${t}.${e}`,a.setAttribute("target","_blank"),a.click(),a.remove()}}return t.\u0275fac=function(e){return new(e||t)(o.Mb(b.a),o.Mb(s.a),o.Mb(l.a))},t.\u0275cmp=o.Gb({type:t,selectors:[["app-facturas"]],decls:77,vars:13,consts:[[2,"text-align","right"],["mat-button","",3,"matMenuTriggerFor"],["perfil","matMenu"],[2,"text-align","center"],["src","assets/imgs/avatar-01.jpg","alt",""],[2,"font-weight","bold"],["mat-menu-item","",3,"click"],["mat-raised-button","",1,"exportar",3,"disabled","matMenuTriggerFor"],["exportar","matMenu"],["tvsItemSize","",1,"wrapper","mat-elevation-z2"],["mat-table","",3,"dataSource"],["mat-header-row","","class","tablaHeader",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","factura"],["matColumnDef","rfc"],["matColumnDef","awb"],["matColumnDef","hbw"],["matColumnDef","pedimento"],["matColumnDef","fecha"],["matColumnDef","agente"],["matColumnDef","opciones"],["mat-header-row","",1,"tablaHeader"],["mat-row",""],["mat-header-cell",""],[2,"background","white",3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[2,"background","white",3,"checked","aria-label","click","change"],[3,"click"],["mat-list-icon",""]],template:function(t,e){if(1&t&&(o.Sb(0,"p",0),o.Sb(1,"mat-toolbar"),o.Sb(2,"button",1),o.xc(3),o.Sb(4,"mat-icon"),o.xc(5,"expand_more"),o.Rb(),o.Rb(),o.Rb(),o.Rb(),o.Sb(6,"mat-menu",null,2),o.Sb(8,"div",3),o.Nb(9,"img",4),o.Sb(10,"p",5),o.xc(11),o.Rb(),o.Nb(12,"mat-divider"),o.Sb(13,"p"),o.xc(14),o.Rb(),o.Nb(15,"mat-divider"),o.Rb(),o.Sb(16,"div",3),o.Sb(17,"span"),o.xc(18),o.ec(19,"uppercase"),o.Rb(),o.Rb(),o.Nb(20,"mat-divider"),o.Sb(21,"button",6),o.Zb("click",(function(){return e.auth.cerrarSesion()})),o.Sb(22,"mat-icon"),o.xc(23,"assignment_return"),o.Rb(),o.Sb(24,"span"),o.xc(25,"Cerrar sesion"),o.Rb(),o.Rb(),o.Rb(),o.Sb(26,"div",0),o.Sb(27,"button",7),o.xc(28," Exportar "),o.Rb(),o.Rb(),o.Sb(29,"mat-menu",null,8),o.Sb(31,"button",6),o.Zb("click",(function(){return e.descargarPdfsYXmls()})),o.Sb(32,"mat-icon"),o.xc(33,"cloud_download"),o.Rb(),o.Sb(34,"span"),o.xc(35,"Descargar archivos PDFs y XMLs"),o.Rb(),o.Rb(),o.Sb(36,"button",6),o.Zb("click",(function(){return e.descargarPdfs()})),o.Sb(37,"mat-icon"),o.xc(38,"cloud_download"),o.Rb(),o.Sb(39,"span"),o.xc(40,"Descargar solo PDFs"),o.Rb(),o.Rb(),o.Sb(41,"button",6),o.Zb("click",(function(){return e.descargarXmls()})),o.Sb(42,"mat-icon"),o.xc(43,"cloud_download"),o.Rb(),o.Sb(44,"span"),o.xc(45,"Descargar solo XMLs"),o.Rb(),o.Rb(),o.Rb(),o.Sb(46,"cdk-virtual-scroll-viewport",9),o.Sb(47,"table",10),o.wc(48,w,1,0,"tr",11),o.wc(49,x,1,0,"tr",12),o.Qb(50,13),o.wc(51,M,2,3,"th",14),o.wc(52,k,2,2,"td",15),o.Pb(),o.Qb(53,16),o.wc(54,v,2,0,"th",14),o.wc(55,P,2,1,"td",15),o.Pb(),o.Qb(56,17),o.wc(57,C,2,0,"th",14),o.wc(58,D,2,1,"td",15),o.Pb(),o.Qb(59,18),o.wc(60,y,2,0,"th",14),o.wc(61,$,2,1,"td",15),o.Pb(),o.Qb(62,19),o.wc(63,B,2,0,"th",14),o.wc(64,_,2,1,"td",15),o.Pb(),o.Qb(65,20),o.wc(66,F,2,0,"th",14),o.wc(67,O,2,1,"td",15),o.Pb(),o.Qb(68,21),o.wc(69,T,2,0,"th",14),o.wc(70,Z,2,1,"td",15),o.Pb(),o.Qb(71,22),o.wc(72,N,2,0,"th",14),o.wc(73,j,2,1,"td",15),o.Pb(),o.Qb(74,23),o.wc(75,A,2,0,"th",14),o.wc(76,z,10,0,"td",15),o.Pb(),o.Rb(),o.Rb()),2&t){const t=o.nc(7),a=o.nc(30);o.Bb(2),o.ic("matMenuTriggerFor",t),o.Bb(1),o.zc(" ",null==e.auth.usuario?null:e.auth.usuario.nombre," "),o.Bb(8),o.yc(null==e.auth.usuario?null:e.auth.usuario.nombre),o.Bb(3),o.yc(null==e.auth.usuario?null:e.auth.usuario.correo),o.Bb(4),o.yc(o.fc(19,11,null==e.auth.usuario?null:e.auth.usuario.idrol.rol)),o.Bb(9),o.ic("disabled",e.selection.isEmpty())("matMenuTriggerFor",a),o.Bb(20),o.ic("dataSource",e.facturaTabla),o.Bb(1),o.ic("matHeaderRowDef",e.displayedColumnsPrueba)("matHeaderRowDefSticky",!0),o.Bb(1),o.ic("matRowDefColumns",e.displayedColumnsPrueba)}},directives:[u.a,d.a,m.c,f.a,m.d,h.a,m.a,p.c,r.a,g.j,g.g,g.i,g.c,g.e,g.b,g.f,g.h,g.d,S.a,g.a,R.b],pipes:[c.p],styles:[".wrapper[_ngcontent-%COMP%]{height:550px}table[_ngcontent-%COMP%]{width:100%}.mat-toolbar[_ngcontent-%COMP%]{background:#f5f5f5;color:#000}.tablaHeader[_ngcontent-%COMP%]{font-size:14px;background-color:#0f0f0f}.exportar[_ngcontent-%COMP%], .mat-header-cell[_ngcontent-%COMP%]{color:#fff}.exportar[_ngcontent-%COMP%]{background-color:#333;margin-bottom:10px;margin-right:20px}.exportar[_ngcontent-%COMP%]:hover{background-color:#bbb;color:#fff}.fecha[_ngcontent-%COMP%]{background-color:#333;color:#fff;margin-bottom:10px;margin-left:25px}"]}),t})();var Q=a("tyNb"),Y=a("XhcP");function I(t,e){if(1&t&&(o.Sb(0,"div"),o.Sb(1,"mat-list-item",4),o.xc(2),o.Sb(3,"mat-icon",5),o.xc(4),o.Rb(),o.Rb(),o.Nb(5,"mat-divider"),o.Rb()),2&t){const t=e.$implicit;o.Bb(1),o.ic("routerLink",t.ruta),o.Bb(1),o.zc(" ",t.titulo," "),o.Bb(2),o.zc(" ",t.icon,"")}}let X=(()=>{class t{constructor(){this.menuOpciones=[{icon:"receipt",ruta:"facturas",titulo:"Facturas"}]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Gb({type:t,selectors:[["app-agente"]],decls:8,vars:1,consts:[["mode","side","opened",""],[2,"text-align","center"],["src","assets/imgs/logo_swissport_mini.png","alt",""],[4,"ngFor","ngForOf"],[2,"text-align","right",3,"routerLink"],["mat-list-icon",""]],template:function(t,e){1&t&&(o.Sb(0,"mat-sidenav-container"),o.Sb(1,"mat-sidenav",0),o.Sb(2,"mat-toolbar",1),o.Nb(3,"img",2),o.Rb(),o.Sb(4,"mat-list"),o.wc(5,I,6,3,"div",3),o.Rb(),o.Rb(),o.Sb(6,"mat-sidenav-content"),o.Nb(7,"router-outlet"),o.Rb(),o.Rb()),2&t&&(o.Bb(5),o.ic("ngForOf",e.menuOpciones))},directives:[Y.b,Y.a,u.a,R.a,c.i,Y.c,Q.e,R.c,Q.b,f.a,R.b,h.a],styles:["mat-sidenav-container[_ngcontent-%COMP%]{height:100%}mat-sidenav[_ngcontent-%COMP%]{width:20%}"]}),t})();var H=a("zkoq"),L=a("FKr1");const V=[{path:"",component:X,children:[{path:"",redirectTo:"facturas",pathMatch:"full"},{path:"facturas",component:E}]}],G={parse:{dateInput:"DD-MM-YYYY"},display:{dateInput:"DD-MM-YYYY"}};let K=(()=>{class t{}return t.\u0275mod=o.Kb({type:t}),t.\u0275inj=o.Jb({factory:function(e){return new(e||t)},providers:[{provide:L.c,useValue:G}],imports:[[c.b,Q.d.forChild(V),Y.d,u.b,R.d,f.b,m.b,H.b,p.e,g.l,r.c,S.b,b.b,s.b,d.b]]}),t})()}}]);