!function(){function e(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,n=new Array(o);t<o;t++)n[t]=e[t];return n}function t(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function n(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"o+dm":function(o,n,a){"use strict";a.r(n),a.d(n,"PagosPageModule",(function(){return q}));var i=a("ofXK"),c=a("TEn/"),s=a("tyNb"),l=a("mrSG"),b=a("3Pt+"),u=a("AytR"),p=a("fXoL"),g=a("tk/3");function f(e,o){1&e&&(p.Kb(0,"p"),p.gc(1,"El RFC es necesario"),p.Jb())}function d(e,o){if(1&e&&(p.Kb(0,"ion-text",6),p.fc(1,f,2,0,"p",27),p.Kb(2,"p"),p.gc(3," El RFC "),p.Kb(4,"ion-badge",28),p.gc(5,"NO EXISTE"),p.Jb(),p.Jb(),p.Jb()),2&e){var t=p.Ub();p.xb(1),p.Zb("ngIf",(null==t.pagoForm.controls.rfc.errors?null:t.pagoForm.controls.rfc.errors.required)&&t.pagoForm.controls.rfc.dirty)}}function m(e,o){1&e&&(p.Kb(0,"ion-text",29),p.Kb(1,"p"),p.gc(2," El RFC "),p.Kb(3,"ion-badge",30),p.gc(4,"EXISTE"),p.Jb(),p.Jb(),p.Jb())}function h(e,o){if(1&e&&(p.Kb(0,"ion-item",31),p.Kb(1,"ion-label",29),p.gc(2),p.Jb(),p.Jb()),2&e){var t=p.Ub();p.xb(2),p.ic("PDF seleccionado: ",t.pdf.name,"")}}function v(e,o){if(1&e&&(p.Kb(0,"ion-item",31),p.Kb(1,"ion-label",29),p.gc(2),p.Jb(),p.Jb()),2&e){var t=p.Ub();p.xb(2),p.ic("XML seleccionado: ",t.xml.name,"")}}var J,K=((J=function(){function e(o,n,r){t(this,e),this.http=o,this.toastCtrl=n,this.cargando=r}return r(e,[{key:"ngOnInit",value:function(){this.cargarForm()}},{key:"crearPago",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mostrarCargando();case 2:o={agente:this.pagoForm.value.agente,almacen:this.pagoForm.value.almacen,awb:this.pagoForm.value.awb,factura:this.pagoForm.value.factura,hbw:this.pagoForm.value.hbw,pedimento:this.pagoForm.value.pedimento,rfc:this.pagoForm.value.rfc,fecha:(new Date).toISOString()},this.subirArchivo(this.pagoForm.value.factura,this.pdf).then((function(){return t.subirArchivo(t.pagoForm.value.factura,t.xml)})).then((function(){return t.http.post(u.a.apiUrl+"/pagos",o).toPromise()})).then((function(e){console.log("Resp de crear factura",e),e.success?(t.cargando.dismiss(),t.mostrarToast("Se creo correctamente la factura","success"),t.pagoForm.reset({agente:null,almacen:null,awb:null,factura:null,hbw:null,pedimento:null,rfc:null,pdf:!1,xml:!1}),t.pdf=void 0,t.xml=void 0):(t.cargando.dismiss(),t.mostrarToast("Error al crear la factura","danger"))})).catch((function(e){t.cargando.dismiss(),t.mostrarToast("Error al crear la factura","danger"),console.log("Error al subir archivos",e)})),console.log("La factura final sera",o);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"subirArchivo",value:function(e,o){var t=o.type.split("/")[1],n=new FormData;return n.append("file",o,e+"."+t),this.http.post(u.a.apiUrl+"/upload",n).toPromise().then((function(e){console.log("Resp para subir archivos",e)})).catch((function(e){return console.log("Error al subir archivos",e)}))}},{key:"seleccionarArchivo",value:function(e){0==(e.target||e.srcElement).value.length?console.log("Cancelo la seleccion"):(console.log("Archivo seleccionado",e.target.files[0]),e.target.files[0].type.endsWith("/pdf")?(this.pdf=e.target.files[0],this.pagoForm.controls.pdf.setValue(!0)):e.target.files[0].type.endsWith("/xml")&&(this.xml=e.target.files[0],this.pagoForm.controls.xml.setValue(!0)))}},{key:"mostrarCargando",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.cargando.create({message:"Subiendo archivos y guardando la factura, espere....",backdropDismiss:!1});case 2:return o=e.sent,e.next=5,o.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"cargarForm",value:function(){this.pagoForm=new b.d({agente:new b.b(null,b.o.required),almacen:new b.b(null,b.o.required),awb:new b.b(null,b.o.required),factura:new b.b(null,b.o.required),hbw:new b.b(null,b.o.required),pedimento:new b.b(null,b.o.required),rfc:new b.b(null,b.o.required,this.rfcUnico.bind(this)),pdf:new b.b(!1,b.o.requiredTrue),xml:new b.b(!1,b.o.requiredTrue)})}},{key:"rfcUnico",value:function(e){var o=this;return new Promise((function(e,t){o.http.get("".concat(u.a.apiUrl,"/usuario/rfc/?rfc=").concat(o.pagoForm.controls.rfc.value)).subscribe((function(o){console.log("Se hizo bien",o),e(1==o.data.length?null:{existe:!0})}),(function(o){console.log("Se hizo MAL",o),e({existe:!0})}))}))}},{key:"mostrarToast",value:function(e,o){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastCtrl.create({message:e,color:o,duration:3e3});case 2:return t.abrupt("return",t.sent.present());case 3:case"end":return t.stop()}}),t,this)})))}}]),e}()).\u0275fac=function(e){return new(e||J)(p.Hb(g.a),p.Hb(c.T),p.Hb(c.O))},J.\u0275cmp=p.Bb({type:J,selectors:[["app-crear-pago"]],decls:84,vars:6,consts:[[1,"ion-text-center"],["slot","start"],["routerLink","..","color","dark"],["name","chevron-back-circle"],[3,"formGroup","ngSubmit"],["position","floating"],["color","danger"],["required","","formControlName","agente","type","text"],["required","","formControlName","almacen","type","text"],["required","","formControlName","awb","type","text"],["required","","formControlName","factura","type","text"],["required","","formControlName","hbw","type","text"],["required","","formControlName","pedimento","type","text"],["required","","debounce","1000","formControlName","rfc","oninput","this.value = this.value.toUpperCase()","type","text"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["fixed",""],["size","6"],["name","document-outline",2,"font-size","150px"],["color","dark","expand","block","shape","round",3,"click"],["slot","start","name","add"],["style","text-align: center;",4,"ngIf"],["name","code-working",2,"font-size","150px"],["expand","block","color","dark","shape","round",3,"click"],["expand","full",3,"disabled","click"],["type","file","accept",".pdf,.xml",2,"display","none",3,"change"],["archivos",""],[4,"ngIf"],["color","danger","mode","ios"],["color","success"],["color","success","mode","ios"],[2,"text-align","center"]],template:function(e,o){if(1&e){var t=p.Lb();p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-buttons",1),p.Kb(3,"ion-button",2),p.Ib(4,"ion-icon",3),p.gc(5," Regresar "),p.Jb(),p.Jb(),p.Kb(6,"ion-title"),p.gc(7,"Crear pago"),p.Jb(),p.Jb(),p.Jb(),p.Kb(8,"ion-content"),p.Kb(9,"ion-card"),p.Kb(10,"form",4),p.Sb("ngSubmit",(function(){return o.crearPago()})),p.Kb(11,"ion-item"),p.Kb(12,"ion-label",5),p.gc(13,"Agente "),p.Kb(14,"ion-text",6),p.gc(15,"*"),p.Jb(),p.Jb(),p.Ib(16,"ion-input",7),p.Jb(),p.Kb(17,"ion-item"),p.Kb(18,"ion-label",5),p.gc(19,"Almacen "),p.Kb(20,"ion-text",6),p.gc(21,"*"),p.Jb(),p.Jb(),p.Ib(22,"ion-input",8),p.Jb(),p.Kb(23,"ion-item"),p.Kb(24,"ion-label",5),p.gc(25,"AWB "),p.Kb(26,"ion-text",6),p.gc(27,"*"),p.Jb(),p.Jb(),p.Ib(28,"ion-input",9),p.Jb(),p.Kb(29,"ion-item"),p.Kb(30,"ion-label",5),p.gc(31,"Factura "),p.Kb(32,"ion-text",6),p.gc(33,"*"),p.Jb(),p.Jb(),p.Ib(34,"ion-input",10),p.Jb(),p.Kb(35,"ion-item"),p.Kb(36,"ion-label",5),p.gc(37,"HBW "),p.Kb(38,"ion-text",6),p.gc(39,"*"),p.Jb(),p.Jb(),p.Ib(40,"ion-input",11),p.Jb(),p.Kb(41,"ion-item"),p.Kb(42,"ion-label",5),p.gc(43,"Pedimento "),p.Kb(44,"ion-text",6),p.gc(45,"*"),p.Jb(),p.Jb(),p.Ib(46,"ion-input",12),p.Jb(),p.Kb(47,"ion-item"),p.Kb(48,"ion-label",5),p.gc(49,"RFC "),p.Kb(50,"ion-text",6),p.gc(51,"*"),p.Jb(),p.Jb(),p.Ib(52,"ion-input",13),p.fc(53,d,6,1,"ion-text",14),p.fc(54,m,5,0,"ion-text",15),p.Jb(),p.Jb(),p.Jb(),p.Kb(55,"ion-card"),p.Kb(56,"ion-grid",16),p.Kb(57,"ion-row"),p.Kb(58,"ion-col",17),p.Kb(59,"ion-card"),p.Kb(60,"ion-card-header",0),p.Kb(61,"ion-card-title"),p.gc(62,"Archivo PDF necesario"),p.Jb(),p.Jb(),p.Kb(63,"ion-card-content",0),p.Ib(64,"ion-icon",18),p.Jb(),p.Kb(65,"ion-button",19),p.Sb("click",(function(){return p.cc(t),p.bc(83).click()})),p.gc(66," Seleccionar PDF "),p.Ib(67,"ion-icon",20),p.Jb(),p.fc(68,h,3,1,"ion-item",21),p.Jb(),p.Jb(),p.Kb(69,"ion-col",17),p.Kb(70,"ion-card"),p.Kb(71,"ion-card-header",0),p.Kb(72,"ion-card-title"),p.gc(73,"Archivo XML necesario"),p.Jb(),p.Jb(),p.Kb(74,"ion-card-content",0),p.Ib(75,"ion-icon",22),p.Jb(),p.Kb(76,"ion-button",23),p.Sb("click",(function(){return p.cc(t),p.bc(83).click()})),p.gc(77," Seleccionar XML "),p.Ib(78,"ion-icon",20),p.Jb(),p.fc(79,v,3,1,"ion-item",21),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Kb(80,"ion-button",24),p.Sb("click",(function(){return o.crearPago()})),p.gc(81," Crear pago "),p.Jb(),p.Jb(),p.Kb(82,"input",25,26),p.Sb("change",(function(e){return o.seleccionarArchivo(e)})),p.Jb(),p.Jb()}2&e&&(p.xb(10),p.Zb("formGroup",o.pagoForm),p.xb(43),p.Zb("ngIf",null==o.pagoForm.controls.rfc.errors?null:o.pagoForm.controls.rfc.errors.existe),p.xb(1),p.Zb("ngIf",o.pagoForm.controls.rfc.valid),p.xb(14),p.Zb("ngIf",null!=o.pdf),p.xb(11),p.Zb("ngIf",null!=o.xml),p.xb(1),p.Zb("disabled",o.pagoForm.invalid))},directives:[c.r,c.K,c.g,c.f,c.Q,s.g,c.s,c.J,c.n,c.h,b.p,b.j,b.e,c.u,c.v,c.I,c.t,c.S,b.n,b.i,b.c,i.j,c.q,c.A,c.m,c.j,c.k,c.i,c.e],styles:[""]}),J);function x(e,o){1&e&&(p.Kb(0,"p"),p.gc(1,"El RFC es necesario"),p.Jb())}function w(e,o){if(1&e&&(p.Kb(0,"ion-text",8),p.fc(1,x,2,0,"p",19),p.Kb(2,"p"),p.gc(3," El RFC "),p.Kb(4,"ion-badge",20),p.gc(5,"NO EXISTE"),p.Jb(),p.Jb(),p.Jb()),2&e){var t=p.Ub();p.xb(1),p.Zb("ngIf",(null==t.pagoForm.controls.rfc.errors?null:t.pagoForm.controls.rfc.errors.required)&&t.pagoForm.controls.rfc.dirty)}}function y(e,o){1&e&&(p.Kb(0,"ion-text",21),p.Kb(1,"p"),p.gc(2," El RFC "),p.Kb(3,"ion-badge",22),p.gc(4,"EXISTE"),p.Jb(),p.Jb(),p.Jb())}var k,F=((k=function(){function e(o,n,r){t(this,e),this.modalCtrl=o,this.http=n,this.toastCtrl=r,this.rfc=""}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.cargarFormulario(),this.modalCtrl.getTop().then((function(o){console.log("Los datos recibidos son: ",o.componentProps),e.rfc=o.componentProps.rfc,e.id=o.componentProps.id,e.pagoForm.setValue({agente:o.componentProps.agente,almacen:o.componentProps.almacen,awb:o.componentProps.awb,factura:o.componentProps.factura,hbw:o.componentProps.hbw,pedimento:o.componentProps.pedimento,rfc:o.componentProps.rfc})})).catch((function(e){return console.log("Error al cargar el modal",e)}))}},{key:"editarPago",value:function(){var e=this,o=Object.assign(Object.assign({},this.pagoForm.value),{fecha:(new Date).toISOString(),id:this.id});this.http.put(u.a.apiUrl+"/pagos",o).subscribe((function(o){console.log("Resp de actualizar factura",o),o.success?e.cerrarModal(!0,o.data):e.mostrarToast("Error al crear la factura","danger")}),(function(o){e.mostrarToast("Error al crear la factura","danger"),console.log("Error al crear la factura",o)})),console.log("La factura final sera",o)}},{key:"rfcUnico",value:function(e){var o=this;return new Promise((function(e,t){return Object(l.b)(o,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.http.get("".concat(u.a.apiUrl,"/usuario/rfc/?rfc=").concat(this.pagoForm.controls.rfc.value)).subscribe((function(o){console.log("Se hizo bien",o),e(1==o.data.length?null:{existe:!0})}),(function(o){console.log("Se hizo MAL",o),e({existe:!0})}));case 2:case"end":return o.stop()}}),o,this)})))}))}},{key:"mostrarToast",value:function(e,o){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastCtrl.create({message:e,color:o,duration:3e3});case 2:return t.abrupt("return",t.sent.present());case 3:case"end":return t.stop()}}),t,this)})))}},{key:"cerrarModal",value:function(e,o){this.modalCtrl.dismiss({completado:e,nuevo:o})}},{key:"cargarFormulario",value:function(){this.pagoForm=new b.d({agente:new b.b(null,b.o.required),almacen:new b.b(null,b.o.required),awb:new b.b(null,b.o.required),factura:new b.b(null,b.o.required),hbw:new b.b(null,b.o.required),pedimento:new b.b(null,b.o.required),rfc:new b.b(null,b.o.required,this.rfcUnico.bind(this))})}}]),e}()).\u0275fac=function(e){return new(e||k)(p.Hb(c.P),p.Hb(g.a),p.Hb(c.T))},k.\u0275cmp=p.Bb({type:k,selectors:[["app-editar-pago"]],decls:71,vars:5,consts:[[1,"ion-text-center"],["slot","start"],["color","dark",3,"click"],["name","chevron-back-circle"],[3,"formGroup","ngSubmit"],["fixed",""],["size","6"],["position","floating"],["color","danger"],["required","","formControlName","agente","type","text"],["required","","formControlName","almacen","type","text"],["required","","formControlName","awb","type","text"],["required","","formControlName","factura","type","text"],["required","","formControlName","hbw","type","text"],["required","","formControlName","pedimento","type","text"],["required","","formControlName","rfc","type","text"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["type","submit","expand","full",3,"disabled"],[4,"ngIf"],["color","danger","mode","ios"],["color","success"],["color","success","mode","ios"]],template:function(e,o){1&e&&(p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-buttons",1),p.Kb(3,"ion-button",2),p.Sb("click",(function(){return o.cerrarModal(!1)})),p.Ib(4,"ion-icon",3),p.gc(5," Cancelar "),p.Jb(),p.Jb(),p.Kb(6,"ion-title"),p.gc(7),p.Jb(),p.Jb(),p.Jb(),p.Kb(8,"ion-content"),p.Kb(9,"ion-card"),p.Kb(10,"ion-card-header",0),p.Kb(11,"ion-card-title"),p.gc(12,"Ingresa los nuevos datos "),p.Jb(),p.Jb(),p.Kb(13,"ion-card-content"),p.Kb(14,"form",4),p.Sb("ngSubmit",(function(){return o.editarPago()})),p.Kb(15,"ion-grid",5),p.Kb(16,"ion-row"),p.Kb(17,"ion-col",6),p.Kb(18,"ion-item"),p.Kb(19,"ion-label",7),p.gc(20,"Agente "),p.Kb(21,"ion-text",8),p.gc(22,"*"),p.Jb(),p.Jb(),p.Ib(23,"ion-input",9),p.Jb(),p.Jb(),p.Kb(24,"ion-col",6),p.Kb(25,"ion-item"),p.Kb(26,"ion-label",7),p.gc(27,"Almacen "),p.Kb(28,"ion-text",8),p.gc(29,"*"),p.Jb(),p.Jb(),p.Ib(30,"ion-input",10),p.Jb(),p.Jb(),p.Jb(),p.Kb(31,"ion-row"),p.Kb(32,"ion-col",6),p.Kb(33,"ion-item"),p.Kb(34,"ion-label",7),p.gc(35,"AWB "),p.Kb(36,"ion-text",8),p.gc(37,"*"),p.Jb(),p.Jb(),p.Ib(38,"ion-input",11),p.Jb(),p.Jb(),p.Kb(39,"ion-col",6),p.Kb(40,"ion-item"),p.Kb(41,"ion-label",7),p.gc(42,"Factura "),p.Kb(43,"ion-text",8),p.gc(44,"*"),p.Jb(),p.Jb(),p.Ib(45,"ion-input",12),p.Jb(),p.Jb(),p.Jb(),p.Kb(46,"ion-row"),p.Kb(47,"ion-col",6),p.Kb(48,"ion-item"),p.Kb(49,"ion-label",7),p.gc(50,"HBW "),p.Kb(51,"ion-text",8),p.gc(52,"*"),p.Jb(),p.Jb(),p.Ib(53,"ion-input",13),p.Jb(),p.Jb(),p.Kb(54,"ion-col",6),p.Kb(55,"ion-item"),p.Kb(56,"ion-label",7),p.gc(57,"Pedimento "),p.Kb(58,"ion-text",8),p.gc(59,"*"),p.Jb(),p.Jb(),p.Ib(60,"ion-input",14),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Kb(61,"ion-item"),p.Kb(62,"ion-label",7),p.gc(63,"RFC "),p.Kb(64,"ion-text",8),p.gc(65,"*"),p.Jb(),p.Jb(),p.Ib(66,"ion-input",15),p.fc(67,w,6,1,"ion-text",16),p.fc(68,y,5,0,"ion-text",17),p.Jb(),p.Kb(69,"ion-button",18),p.gc(70," Actualizar pago "),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Jb()),2&e&&(p.xb(7),p.ic("RFC ",o.rfc,""),p.xb(7),p.Zb("formGroup",o.pagoForm),p.xb(53),p.Zb("ngIf",null==o.pagoForm.controls.rfc.errors?null:o.pagoForm.controls.rfc.errors.existe),p.xb(1),p.Zb("ngIf",o.pagoForm.controls.rfc.valid),p.xb(1),p.Zb("disabled",o.pagoForm.untouched))},directives:[c.r,c.K,c.g,c.f,c.s,c.J,c.n,c.h,c.j,c.k,c.i,b.p,b.j,b.e,c.q,c.A,c.m,c.u,c.v,c.I,c.t,c.S,b.n,b.i,b.c,i.j,c.e],styles:[""]}),k),C=a("lGQG");function I(e,o){if(1&e){var t=p.Lb();p.Kb(0,"ion-item"),p.Kb(1,"ion-checkbox",5),p.Sb("ngModelChange",(function(e){return p.cc(t),o.$implicit.check=e})),p.Jb(),p.Kb(2,"ion-label"),p.gc(3," RFC "),p.Kb(4,"p"),p.gc(5),p.Jb(),p.Jb(),p.Kb(6,"ion-label"),p.gc(7," Agente "),p.Kb(8,"p"),p.gc(9),p.Jb(),p.Jb(),p.Kb(10,"ion-label"),p.gc(11," Factura "),p.Kb(12,"p"),p.gc(13),p.Jb(),p.Jb(),p.Kb(14,"ion-label"),p.gc(15," pedimento "),p.Kb(16,"p"),p.gc(17),p.Jb(),p.Jb(),p.Kb(18,"ion-label"),p.gc(19," Fecha "),p.Kb(20,"p"),p.gc(21),p.Jb(),p.Jb(),p.Jb()}if(2&e){var n=o.$implicit;p.xb(1),p.Zb("ngModel",n.check),p.xb(4),p.ic(" ",n.rfc," "),p.xb(4),p.ic(" ",n.agente," "),p.xb(4),p.ic(" ",n.factura," "),p.xb(4),p.ic(" ",n.pedimento," "),p.xb(4),p.ic(" ",n.fecha," ")}}var S,P,A,R=[{path:"",component:(S=function(){function o(e,n,r,a,i){t(this,o),this.http=e,this.actionSheetController=n,this.modalCtrl=r,this.toastCtrl=a,this.auth=i,this.seleccionados=[]}return r(o,[{key:"ngOnInit",value:function(){this.cargarPagos()}},{key:"seleccionar",value:function(){var e=this;this.pagos.forEach((function(o,t){o.check&&e.seleccionados.push({index:t,factura:o.factura})})),1==this.seleccionados.length?this.mostrarOpcionesIndividual(this.seleccionados[0].index):this.mostrarOpcionesMultiple(),console.log("Seleccionados",this.seleccionados)}},{key:"cargarPagos",value:function(){var e=this;this.http.get(u.a.apiUrl+"/pagos").subscribe((function(o){o.data.length>0&&(e.pagos=o.data),console.log("Resp de las peticion",o)}),(function(e){console.log("Error al buscar pagos",e)}))}},{key:"buscarPago",value:function(e){console.log(e),this.pagoPeticion("prueba"==e.detail.value||13==e.detail.value.length?"rfc?rfc="+e.detail.value:"pago?factura="+e.detail.value)}},{key:"mostrarOpcionesMultiple",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:"Que deseas hacer con las facturas seleccionadas : ",cssClass:"my-custom-class",buttons:[{text:"Descargar xml y pdf seleccionados",icon:"cloud-download",handler:function(){}},{text:"Eliminar",icon:"trash",handler:function(){}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return o=e.sent,e.next=5,o.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"mostrarOpcionesIndividual",value:function(e){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function o(){var t,n=this;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.actionSheetController.create({header:"Que deseas hacer con la factura con RFC : "+this.pagos[e].rfc+", Agente: "+this.pagos[e].agente,cssClass:"my-custom-class",buttons:[{text:"Eliminar",icon:"trash",handler:function(){n.eliminarPago(e)}},{text:"Editar",icon:"create",handler:function(){n.editarFactura(e)}},{text:"Abrir archivo XML",icon:"code-working",handler:function(){n.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:function(){n.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return t=o.sent,o.next=5,t.present();case 5:this.seleccionados=[];case 6:case"end":return o.stop()}}),o,this)})))}},{key:"abrirArchivo",value:function(e,o){var t=document.createElement("a");t.href="".concat(u.a.apiFile,"/file/").concat(this.pagos[e].factura,".").concat(o),t.setAttribute("target","_blank"),t.click(),t.remove()}},{key:"editarFactura",value:function(e){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function o(){var t,n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.modalCtrl.create({component:F,componentProps:this.pagos[e],backdropDismiss:!1});case 2:return t=o.sent,o.next=5,t.present();case 5:return o.next=7,t.onWillDismiss();case 7:(n=o.sent).data.completado&&(this.mostrarToast("Se gurdo correctamente","success"),console.log("ASi vienen los datos ",n.data),this.pagos[e]=n.data.nuevo);case 9:case"end":return o.stop()}}),o,this)})))}},{key:"eliminarPago",value:function(o){var t=this;this.http.delete("".concat(u.a.apiUrl,"/pagos/id?id=").concat(this.pagos[o].id)).subscribe((function(n){n.success?(t.actionSheetController.dismiss(),t.mostrarToast("Se elimino correctamente","success"),t.pagos.splice(o,1),console.log("Se deberia borrar",t.pagos),t.pagos=e(t.pagos)):t.mostrarToast("Algo salio mal...","danger")}))}},{key:"pagoPeticion",value:function(e){var o=this;this.http.get("".concat(u.a.apiUrl,"/pagos/").concat(e)).subscribe((function(e){e.data.length>0&&(o.pagos=e.data),console.log("Resp de las peticion",e)}),(function(e){console.log("Error al buscar pagos",e)}))}},{key:"mostrarToast",value:function(e,o){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastCtrl.create({message:e,color:o,duration:3e3});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}}]),o}(),S.\u0275fac=function(e){return new(e||S)(p.Hb(g.a),p.Hb(c.a),p.Hb(c.P),p.Hb(c.T),p.Hb(C.a))},S.\u0275cmp=p.Bb({type:S,selectors:[["app-pagos"]],decls:10,vars:1,consts:[["color","dark",1,"ion-text-center"],["routerLink","crear"],["placeholder","Buscar pago por RFC o factura","inputmode","text","type","text","debounce","1000","oninput","this.value = this.value.toUpperCase()",3,"ionChange"],[3,"items"],[4,"virtualItem"],[3,"ngModel","ngModelChange"]],template:function(e,o){1&e&&(p.Kb(0,"ion-header"),p.Kb(1,"ion-toolbar",0),p.Kb(2,"ion-title"),p.gc(3,"Pagos"),p.Jb(),p.Kb(4,"ion-button",1),p.gc(5," Crear pago "),p.Jb(),p.Kb(6,"ion-searchbar",2),p.Sb("ionChange",(function(e){return o.buscarPago(e)})),p.Jb(),p.Jb(),p.Jb(),p.Kb(7,"ion-content"),p.Kb(8,"ion-virtual-scroll",3),p.fc(9,I,22,6,"ion-item",4),p.Jb(),p.Jb()),2&e&&(p.xb(8),p.Zb("items",o.pagos))},directives:[c.r,c.K,c.J,c.f,c.Q,s.g,c.B,c.S,c.n,c.L,c.U,c.u,c.l,c.c,b.i,b.k,c.v],styles:[""]}),S)},{path:"crear",component:K}],E=((A=function e(){t(this,e)}).\u0275mod=p.Fb({type:A}),A.\u0275inj=p.Eb({factory:function(e){return new(e||A)},imports:[[s.h.forChild(R)],s.h]}),A),q=((P=function e(){t(this,e)}).\u0275mod=p.Fb({type:P}),P.\u0275inj=p.Eb({factory:function(e){return new(e||P)},imports:[[i.b,c.M,E,b.f,b.m,g.b]]}),P)}}])}();