!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"0NIx":function(n,o,c){"use strict";c.r(o),c.d(o,"UsuarioPageModule",(function(){return A}));var i=c("ofXK"),a=c("3Pt+"),r=c("TEn/"),s=c("tyNb"),l=c("mrSG"),u=c("AytR"),b=c("fXoL"),h=c("tk/3"),f=c("lGQG");function d(e,n){if(1&e&&(b.Kb(0,"p"),b.gc(1),b.Vb(2,"date"),b.Jb()),2&e){var t=b.Ub();b.xb(1),b.hc(b.Wb(2,1,t.fechaInicio))}}function p(e,n){if(1&e&&(b.Kb(0,"p"),b.gc(1),b.Vb(2,"date"),b.Jb()),2&e){var t=b.Ub();b.xb(1),b.hc(b.Wb(2,1,t.fechaFinal))}}function g(e,n){if(1&e){var t=b.Lb();b.Kb(0,"ion-item"),b.Kb(1,"ion-checkbox",11),b.Sb("ngModelChange",(function(e){return b.cc(t),n.$implicit.check=e})),b.Jb(),b.Kb(2,"ion-label"),b.gc(3," RFC "),b.Kb(4,"p"),b.gc(5),b.Jb(),b.Jb(),b.Kb(6,"ion-label"),b.gc(7," Agente "),b.Kb(8,"p"),b.gc(9),b.Jb(),b.Jb(),b.Kb(10,"ion-label"),b.gc(11," Factura "),b.Kb(12,"p"),b.gc(13),b.Jb(),b.Jb(),b.Kb(14,"ion-label"),b.gc(15," pedimento "),b.Kb(16,"p"),b.gc(17),b.Jb(),b.Jb(),b.Kb(18,"ion-label"),b.gc(19," Fecha "),b.Kb(20,"p"),b.gc(21),b.Jb(),b.Jb(),b.Jb()}if(2&e){var o=n.$implicit;b.xb(1),b.Zb("ngModel",o.check),b.xb(4),b.ic(" ",o.rfc," "),b.xb(4),b.ic(" ",o.agente," "),b.xb(4),b.ic(" ",o.factura," "),b.xb(4),b.ic(" ",o.pedimento," "),b.xb(4),b.ic(" ",o.fecha," ")}}var m,v=((m=function(){function n(t,o,c,i){e(this,n),this.http=t,this.auth=o,this.actionSheetController=c,this.toastCtrl=i,this.seleccionados=[],this.fechaInicio="",this.fechaFinal=""}return t(n,[{key:"ngOnInit",value:function(){this.pagoPeticion()}},{key:"setFechaInicio",value:function(e){console.log("la fecha inicio es",e),this.fechaInicio=e}},{key:"setFechaFinal",value:function(e){console.log("la fecha final es",e),this.fechaFinal=e}},{key:"seleccionar",value:function(){var e=this;this.pagos.forEach((function(n,t){n.check&&e.seleccionados.push({index:t,factura:n.factura})})),1==this.seleccionados.length?this.mostrarOpcionesIndividual(this.seleccionados[0].index):this.mostrarOpcionesMultiple(),console.log("Seleccionados",this.seleccionados)}},{key:"mostrarOpcionesMultiple",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:"Que deseas hacer con las facturas seleccionadas : ",cssClass:"my-custom-class",buttons:[{text:"Descargar xml y pdf seleccionados",icon:"cloud-download",handler:function(){}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"mostrarOpcionesIndividual",value:function(e){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.pagos[e].rfc+", Agente: "+this.pagos[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:function(){o.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:function(){o.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return t=n.sent,n.next=5,t.present();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"pagoPeticion",value:function(){var e=this;this.http.get("".concat(u.a.apiUrl,"/pagos/rfc?rfc=").concat(this.auth.usuario.rfc)).subscribe((function(n){n.data.length>0?e.pagos=n.data:e.mostrarToast("No se encontro ninguna","danger"),console.log("Resp de las peticion",n)}),(function(e){console.log("Error al buscar pagos",e)}))}},{key:"mostrarOpciones",value:function(e){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.pagos[e].rfc+", Agente: "+this.pagos[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:function(){o.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:function(){o.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return t=n.sent,n.next=5,t.present();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"abrirArchivo",value:function(e,n){var t=document.createElement("a");t.href="".concat(u.a.apiFile,"/file/").concat(this.pagos[e].factura,".").concat(n),t.setAttribute("target","_blank"),t.click(),t.remove()}},{key:"mostrarToast",value:function(e,n){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastCtrl.create({message:e,color:n,duration:3e3});case 2:return o=t.sent,t.next=5,o.present();case 5:case"end":return t.stop()}}),t,this)})))}}]),n}()).\u0275fac=function(e){return new(e||m)(b.Hb(h.a),b.Hb(f.a),b.Hb(r.a),b.Hb(r.T))},m.\u0275cmp=b.Bb({type:m,selectors:[["app-buscar-pagos"]],decls:26,vars:3,consts:[["color","primary",1,"ion-text-center"],["display-format","YYYY-MM-DD",2,"display","none",3,"ionChange"],["fechasInicio",""],["fechasFinal",""],["size","6"],["expand","block","color","dark",3,"click"],["name","checkbox-outline"],["color","danger","expand","block",3,"click"],[4,"ngIf"],[3,"items"],[4,"virtualItem"],[3,"ngModel","ngModelChange"]],template:function(e,n){if(1&e){var t=b.Lb();b.Kb(0,"ion-header"),b.Kb(1,"ion-toolbar",0),b.Kb(2,"ion-title"),b.gc(3,"Mis pagos"),b.Jb(),b.Kb(4,"ion-datetime",1,2),b.Sb("ionChange",(function(e){return n.setFechaInicio(e.target.value)})),b.Jb(),b.Kb(6,"ion-datetime",1,3),b.Sb("ionChange",(function(e){return n.setFechaFinal(e.target.value)})),b.Jb(),b.Kb(8,"ion-row"),b.Kb(9,"ion-col",4),b.Kb(10,"ion-button",5),b.Sb("click",(function(){return n.seleccionar()})),b.Ib(11,"ion-icon",6),b.gc(12," Opciones de pago 's' seleccionada 's' "),b.Jb(),b.Jb(),b.Kb(13,"ion-col",4),b.Kb(14,"ion-row"),b.Kb(15,"ion-col",4),b.Kb(16,"ion-button",7),b.Sb("click",(function(){return b.cc(t),b.bc(5).open()})),b.gc(17," Fecha de inicio "),b.Jb(),b.fc(18,d,3,3,"p",8),b.Jb(),b.Kb(19,"ion-col",4),b.Kb(20,"ion-button",7),b.Sb("click",(function(){return b.cc(t),b.bc(7).open()})),b.gc(21," Fecha final "),b.Jb(),b.fc(22,p,3,3,"p",8),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Kb(23,"ion-content"),b.Kb(24,"ion-virtual-scroll",9),b.fc(25,g,22,6,"ion-item",10),b.Jb(),b.Jb()}2&e&&(b.xb(18),b.Zb("ngIf",""!=n.fechaInicio),b.xb(4),b.Zb("ngIf",""!=n.fechaFinal),b.xb(2),b.Zb("items",n.pagos))},directives:[r.r,r.K,r.J,r.o,r.R,r.A,r.m,r.f,r.s,i.j,r.n,r.L,r.U,r.u,r.l,r.c,a.i,a.k,r.v],pipes:[i.d],styles:["ion-item[_ngcontent-%COMP%]{--background:#a3a3a3}"]}),m);function x(e,n){if(1&e&&(b.Kb(0,"p"),b.gc(1),b.Vb(2,"date"),b.Jb()),2&e){var t=b.Ub();b.xb(1),b.hc(b.Wb(2,1,t.fechaInicio))}}function k(e,n){if(1&e&&(b.Kb(0,"p"),b.gc(1),b.Vb(2,"date"),b.Jb()),2&e){var t=b.Ub();b.xb(1),b.hc(b.Wb(2,1,t.fechaFinal))}}function J(e,n){if(1&e){var t=b.Lb();b.Kb(0,"ion-item"),b.Kb(1,"ion-checkbox",11),b.Sb("ngModelChange",(function(e){return b.cc(t),n.$implicit.check=e})),b.Jb(),b.Kb(2,"ion-label"),b.gc(3," RFC "),b.Kb(4,"p"),b.gc(5),b.Jb(),b.Jb(),b.Kb(6,"ion-label"),b.gc(7," Agente "),b.Kb(8,"p"),b.gc(9),b.Jb(),b.Jb(),b.Kb(10,"ion-label"),b.gc(11," Factura "),b.Kb(12,"p"),b.gc(13),b.Jb(),b.Jb(),b.Kb(14,"ion-label"),b.gc(15," pedimento "),b.Kb(16,"p"),b.gc(17),b.Jb(),b.Jb(),b.Kb(18,"ion-label"),b.gc(19," Fecha "),b.Kb(20,"p"),b.gc(21),b.Jb(),b.Jb(),b.Jb()}if(2&e){var o=n.$implicit;b.xb(1),b.Zb("ngModel",o.check),b.xb(4),b.ic(" ",o.rfc," "),b.xb(4),b.ic(" ",o.agente," "),b.xb(4),b.ic(" ",o.factura," "),b.xb(4),b.ic(" ",o.pedimento," "),b.xb(4),b.ic(" ",o.fecha," ")}}var K,y=((K=function(){function n(t,o,c,i){e(this,n),this.http=t,this.toastCtrl=o,this.auth=c,this.actionSheetController=i,this.facturas=void 0,this.seleccionados=[],this.fechaInicio="",this.fechaFinal=""}return t(n,[{key:"ngOnInit",value:function(){this.peticionFactura()}},{key:"setFechaInicio",value:function(e){console.log("la fecha inicio es",e),this.fechaInicio=e}},{key:"setFechaFinal",value:function(e){console.log("la fecha final es",e),this.fechaFinal=e}},{key:"seleccionar",value:function(){var e=this;this.facturas.forEach((function(n,t){n.check&&e.seleccionados.push({index:t,factura:n.factura})})),1==this.seleccionados.length?this.mostrarOpcionesIndividual(this.seleccionados[0].index):this.mostrarOpcionesMultiple(),console.log("Seleccionados",this.seleccionados)}},{key:"descargarZip",value:function(){var e=this,n=[];this.seleccionados.forEach((function(e){n.push("C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\"+e.factura+".xml"),n.push("C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\"+e.factura+".pdf")}));var t=(new Date).toISOString();this.http.post("".concat(u.a.apiUrl,"/zip?zipFile=C:\\Program Files\\Apache Software Foundation\\Tomcat 8.5\\webapps\\file\\").concat(t),n).toPromise().then((function(n){console.log("Resp de hacer zip archivos",n),n.success&&e.descargar(t)})).catch((function(n){console.log("Error al comprimir archios",n),e.mostrarToast("Error al descargar el zip","danger")}))}},{key:"descargar",value:function(e){var n=document.createElement("a");n.href="".concat(u.a.apiFile,"/file/").concat(e),n.setAttribute("target","download"),n.click(),n.remove()}},{key:"mostrarOpcionesMultiple",value:function(){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:"Que deseas hacer con las facturas seleccionadas : ",cssClass:"my-custom-class",buttons:[{text:"Descargar xml y pdf seleccionados",icon:"cloud-download",handler:function(){t.descargarZip()}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"mostrarOpcionesIndividual",value:function(e){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var t,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.actionSheetController.create({header:"Que deseas hacer con el pago con RFC : "+this.facturas[e].rfc+", Agente: "+this.facturas[e].agente,cssClass:"my-custom-class",buttons:[{text:"Abrir archivo XML",icon:"code-working",handler:function(){o.abrirArchivo(e,"xml")}},{text:"Abrir archivo PDF",icon:"document",handler:function(){o.abrirArchivo(e,"pdf")}},{text:"Canelar",icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return t=n.sent,n.next=5,t.present();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"abrirArchivo",value:function(e,n){var t=document.createElement("a");t.href="".concat(u.a.apiFile,"/file/").concat(this.facturas[e].factura,".").concat(n),t.setAttribute("target","_blank"),t.click(),t.remove()}},{key:"peticionFactura",value:function(){var e=this;this.http.get("".concat(u.a.apiUrl,"/facturas?rfc=").concat(this.auth.usuario.rfc)).subscribe((function(n){console.log("Resp de buscar factura",n),n.data.length>0?(e.facturas=n.data,e.mostrarToast("Se encontraron","success")):e.mostrarToast("No se encotraron","danger")}),(function(e){console.log("Error al buscar la factura",e)}))}},{key:"mostrarToast",value:function(e,n){return Object(l.b)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastCtrl.create({message:e,color:n,duration:3e3});case 2:return o=t.sent,t.next=5,o.present();case 5:case"end":return t.stop()}}),t,this)})))}}]),n}()).\u0275fac=function(e){return new(e||K)(b.Hb(h.a),b.Hb(r.T),b.Hb(f.a),b.Hb(r.a))},K.\u0275cmp=b.Bb({type:K,selectors:[["app-buscar-facturas"]],decls:26,vars:3,consts:[["color","primary",1,"ion-text-center"],["display-format","YYYY-MM-DD",2,"display","none",3,"ionChange"],["fechasInicio",""],["fechasFinal",""],["size","6"],["expand","block","color","dark",3,"click"],["name","checkbox-outline"],["color","danger","expand","block",3,"click"],[4,"ngIf"],[3,"items"],[4,"virtualItem"],[3,"ngModel","ngModelChange"]],template:function(e,n){if(1&e){var t=b.Lb();b.Kb(0,"ion-header"),b.Kb(1,"ion-toolbar",0),b.Kb(2,"ion-title"),b.gc(3,"Mis facturas"),b.Jb(),b.Kb(4,"ion-datetime",1,2),b.Sb("ionChange",(function(e){return n.setFechaInicio(e.target.value)})),b.Jb(),b.Kb(6,"ion-datetime",1,3),b.Sb("ionChange",(function(e){return n.setFechaFinal(e.target.value)})),b.Jb(),b.Kb(8,"ion-row"),b.Kb(9,"ion-col",4),b.Kb(10,"ion-button",5),b.Sb("click",(function(){return n.seleccionar()})),b.Ib(11,"ion-icon",6),b.gc(12," Opciones Factura 's' seleccionada 's' "),b.Jb(),b.Jb(),b.Kb(13,"ion-col",4),b.Kb(14,"ion-row"),b.Kb(15,"ion-col",4),b.Kb(16,"ion-button",7),b.Sb("click",(function(){return b.cc(t),b.bc(5).open()})),b.gc(17," Fecha de inicio "),b.Jb(),b.fc(18,x,3,3,"p",8),b.Jb(),b.Kb(19,"ion-col",4),b.Kb(20,"ion-button",7),b.Sb("click",(function(){return b.cc(t),b.bc(7).open()})),b.gc(21," Fecha final "),b.Jb(),b.fc(22,k,3,3,"p",8),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Kb(23,"ion-content"),b.Kb(24,"ion-virtual-scroll",9),b.fc(25,J,22,6,"ion-item",10),b.Jb(),b.Jb()}2&e&&(b.xb(18),b.Zb("ngIf",""!=n.fechaInicio),b.xb(4),b.Zb("ngIf",""!=n.fechaFinal),b.xb(2),b.Zb("items",n.facturas))},directives:[r.r,r.K,r.J,r.o,r.R,r.A,r.m,r.f,r.s,i.j,r.n,r.L,r.U,r.u,r.l,r.c,a.i,a.k,r.v],pipes:[i.d],styles:["ion-item[_ngcontent-%COMP%]{--background:#a3a3a3;--background-activated:#07f}"]}),K);function F(e,n){if(1&e&&(b.Kb(0,"ion-item",10),b.Kb(1,"ion-label"),b.gc(2),b.Jb(),b.Ib(3,"ion-icon",11),b.Jb()),2&e){var t=n.$implicit,o=b.Ub();b.zb("active-item",o.selectedPath.startsWith(t.url)),b.Zb("routerLink",t.url),b.xb(2),b.ic(" ",t.titulo," "),b.xb(1),b.Zb("name",t.icon)}}var C,w,I,M=[{path:"",component:(C=function(){function n(t,o){e(this,n),this.auth=t,this.router=o,this.selectedPath="",this.usuarioPages=[{titulo:"Mis facturas",icon:"newspaper",url:"/usuario/facturas"},{titulo:"Mis pagos",icon:"cash",url:"/usuario/pagos"}]}return t(n,[{key:"ngOnInit",value:function(){var e=this;this.router.events.subscribe((function(n){n&&n.url&&(e.selectedPath=n.url)}))}}]),n}(),C.\u0275fac=function(e){return new(e||C)(b.Hb(f.a),b.Hb(s.f))},C.\u0275cmp=b.Bb({type:C,selectors:[["app-usuario"]],decls:19,vars:3,consts:[["contentId","menu-admins"],["menuId","menu-admins","contentId","menu-admins","side","start","type","overlay"],["color","secondary",1,"ion-text-center"],[1,"ion-text-center"],["auto-hide","false"],["routerDirection","forward","class","menuContent",3,"routerLink","active-item",4,"ngFor","ngForOf"],[2,"text-align","center"],["color","danger","mode","ios","fill","solid","shape","round",3,"click"],["name","log-out"],["id","menu-admins"],["routerDirection","forward",1,"menuContent",3,"routerLink"],["mode","ios",3,"name"]],template:function(e,n){1&e&&(b.Kb(0,"ion-split-pane",0),b.Kb(1,"ion-menu",1),b.Kb(2,"ion-header"),b.Kb(3,"ion-toolbar",2),b.Kb(4,"ion-title"),b.gc(5,"Modulo de usuarios"),b.Jb(),b.Kb(6,"ion-card"),b.Kb(7,"ion-card-header"),b.Kb(8,"ion-card-title"),b.gc(9),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Kb(10,"ion-content",3),b.Kb(11,"ion-list"),b.Kb(12,"ion-menu-toggle",4),b.fc(13,F,4,5,"ion-item",5),b.Jb(),b.Kb(14,"ion-item",6),b.Kb(15,"ion-button",7),b.Sb("click",(function(){return n.auth.cerrarSesion()})),b.gc(16," Cerrar sesion "),b.Ib(17,"ion-icon",8),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Jb(),b.Ib(18,"ion-router-outlet",9),b.Jb()),2&e&&(b.xb(9),b.jc("",null==n.auth||null==n.auth.usuario?null:n.auth.usuario.nombre," ",null==n.auth||null==n.auth.usuario?null:n.auth.usuario.apellidos,""),b.xb(4),b.Zb("ngForOf",n.usuarioPages))},directives:[r.E,r.x,r.r,r.K,r.J,r.h,r.j,r.k,r.n,r.w,r.y,i.i,r.u,r.f,r.s,r.z,r.Q,s.g,r.v],styles:[".active-item[_ngcontent-%COMP%]{border-left:8px solid var(--ion-color-primary)}"]}),C),children:[{path:"",redirectTo:"facturas",pathMatch:"full"},{path:"facturas",component:y},{path:"pagos",component:v}]}],S=((I=function n(){e(this,n)}).\u0275mod=b.Fb({type:I}),I.\u0275inj=b.Eb({factory:function(e){return new(e||I)},imports:[[s.h.forChild(M)],s.h]}),I),A=((w=function n(){e(this,n)}).\u0275mod=b.Fb({type:w}),w.\u0275inj=b.Eb({factory:function(e){return new(e||w)},imports:[[i.b,a.f,r.M,S,h.b]]}),w)}}])}();